"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[8676],{18676:(e,s,t)=>{t.r(s),t.d(s,{default:()=>U});var i=t(89379),a=t(65043),n=t(73216),r=t(96446),o=t(81637),l=t(11906),c=t(85865),d=t(67254),m=t(63336),p=t(68903),x=t(81045),h=t(39336),y=t(67784),u=t(53193),g=t(18356),A=t(72221),j=t(32143),v=t(81673),f=t(73158),b=t(87332),C=t(66734),z=t(70579);const S=(0,C.A)((0,z.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"}),"AccountCircle");var W=t(84770),w=t(43374),I=t(51387),k=t(48262),B=t(91082),M=t(37141),L=t(8789),F=t(94505),P=t(66593);const U=()=>{const{id:e}=(0,n.g)(),s=(0,n.Zp)(),t=(0,n.zy)(),C=!!e,[U,D]=(0,a.useState)(!1),[O,T]=(0,a.useState)(!1),[E,H]=(0,a.useState)(null),[R,_]=(0,a.useState)({open:!1,message:"",severity:"success"}),[K,V]=(0,a.useState)({name:"",type:"investor",email:"",phone:"",website:"",address:"",city:"",state:"",zipCode:"",country:"US",description:"",industry:"",size:"",logo:null}),[G,Q]=(0,a.useState)({}),[q,N]=(0,a.useState)(null),[Y,Z]=(0,a.useState)(null),[J,X]=(0,a.useState)(!1);(0,a.useEffect)(()=>{C&&$()},[e,C]);const $=async()=>{try{D(!0);const s=await F.Kp.companies.getById(e);if(s&&s.data){const e=s.data;V({name:e.name||"",type:e.type||"investor",email:e.email||"",phone:e.phone||"",website:e.website||"",address:e.address||"",city:e.city||"",state:e.state||"",zipCode:e.zipCode||"",country:e.country||"US",description:e.description||"",industry:e.industry||"",size:e.size||"",logo:e.logo||null}),e.logo&&Z("http://localhost:3001".concat(e.logo))}}catch(s){H("Failed to load company details"),console.error("Error fetching company:",s)}finally{D(!1)}},ee=e=>s=>{const t=s.target.value;V(s=>(0,i.A)((0,i.A)({},s),{},{[e]:t})),G[e]&&Q(s=>(0,i.A)((0,i.A)({},s),{},{[e]:null}))},{getRootProps:se,getInputProps:te,isDragActive:ie}=(0,L.VB)({onDrop:s=>{const t=s.filter(e=>e.type.startsWith("image/"));t.length!==s.length&&_({open:!0,message:"Only image files are allowed",severity:"warning"}),t.length>0&&(async s=>{const t=s[0];if(t){X(!0);try{const s=(0,P.Wl)(t);if(!s.isValid)return void _({open:!0,message:s.errors[0],severity:"error"});const a=(0,P.zG)("logo",t.type),n=t.size,r=await(0,P.w4)(t,a),o=r.size;if(n>o){const e=((n-o)/n*100).toFixed(1);_({open:!0,message:"Logo compressed: ".concat(e,"% size reduction (").concat(((n-o)/1024/1024).toFixed(1),"MB saved)"),severity:"info"})}N(r);const l=(0,P.aV)(r);if(Z(l),C){const s=await F.Kp.companies.uploadLogo(e,r);V(e=>(0,i.A)((0,i.A)({},e),{},{logo:s.data.logo})),_({open:!0,message:"Logo uploaded successfully",severity:"success"})}}catch(E){console.error("Error processing logo:",E),_({open:!0,message:"Failed to process or upload logo",severity:"error"})}finally{X(!1)}}})([t[0]])},accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"]},multiple:!1,maxSize:10485760}),ae=()=>{s("/companies")};return U?(0,z.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,z.jsx)(o.A,{})}):(0,z.jsxs)(r.A,{children:[(0,z.jsxs)(r.A,{sx:{mb:3},children:[(0,z.jsx)(l.A,{startIcon:(0,z.jsx)(b.A,{}),onClick:ae,sx:{mb:2},children:"Back to Companies"}),(0,z.jsx)(c.A,{variant:"h4",sx:{fontWeight:700},children:C?"Edit Company":"Add New Company"})]}),E&&(0,z.jsx)(d.A,{severity:"error",sx:{mb:3},children:E}),(0,z.jsx)(m.A,{sx:{p:2},children:(0,z.jsx)("form",{onSubmit:async i=>{if(i.preventDefault(),(()=>{const e={};return K.name.trim()||(e.name="Company name is required"),K.type||(e.type="Company type is required"),K.email&&!/\S+@\S+\.\S+/.test(K.email)&&(e.email="Please enter a valid email address"),Q(e),0===Object.keys(e).length})())try{var a;let i;T(!0),C?i=await F.Kp.companies.update(e,K):(i=await F.Kp.companies.create(K),q&&i.data&&i.data.id&&await F.Kp.companies.uploadLogo(i.data.id,q)),_({open:!0,message:"Company ".concat(C?"updated":"created"," successfully"),severity:"success"}),null!==(a=t.state)&&void 0!==a&&a.onUpdate&&t.state.onUpdate(),setTimeout(()=>{s("/companies")},1500)}catch(n){console.error("Error saving company:",n),_({open:!0,message:"Failed to ".concat(C?"update":"create"," company"),severity:"error"})}finally{T(!1)}else _({open:!0,message:"Please fix the errors before submitting",severity:"error"})},children:(0,z.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,z.jsxs)(c.A,{variant:"subtitle1",sx:{mb:1,mt:.5,display:"flex",alignItems:"center",fontWeight:600},children:[(0,z.jsx)(S,{sx:{mr:.5,fontSize:20}}),"Company Logo"]}),(0,z.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:3,mb:3},children:[(0,z.jsx)(x.A,{src:Y,sx:{width:120,height:120,bgcolor:"grey.200",fontSize:"2rem"},children:(0,z.jsx)(W.A,{sx:{fontSize:"3rem",color:"grey.500"}})}),(0,z.jsxs)(r.A,{sx:{flex:1},children:[(0,z.jsxs)(r.A,(0,i.A)((0,i.A)({},se()),{},{sx:{border:"2px dashed",borderColor:ie?"primary.main":"grey.300",borderRadius:2,p:3,textAlign:"center",cursor:"pointer",backgroundColor:ie?"primary.light":"background.paper","&:hover":{backgroundColor:"grey.50"}},children:[(0,z.jsx)("input",(0,i.A)({},te())),(0,z.jsx)(w.A,{sx:{fontSize:32,color:"grey.500",mb:1}}),(0,z.jsx)(c.A,{variant:"body1",gutterBottom:!0,children:ie?"Drop logo here":"Upload Company Logo"}),(0,z.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:["Drag & drop logo here, or click to select",(0,z.jsx)("br",{}),"Supports: JPG, PNG, GIF, WebP (max 10MB)",(0,z.jsx)("br",{}),"Logo will be automatically compressed and optimized"]}),J&&(0,z.jsxs)(r.A,{sx:{mt:2},children:[(0,z.jsx)(o.A,{size:24}),(0,z.jsx)(c.A,{variant:"body2",sx:{mt:1},children:"Processing logo..."})]})]})),Y&&(0,z.jsx)(l.A,{startIcon:(0,z.jsx)(I.A,{}),onClick:async()=>{try{C&&K.logo&&(await F.Kp.companies.removeLogo(e),V(e=>(0,i.A)((0,i.A)({},e),{},{logo:null})),_({open:!0,message:"Logo removed successfully",severity:"success"})),Y&&Y.startsWith("blob:")&&(0,P.Yd)(Y),N(null),Z(null)}catch(E){_({open:!0,message:"Failed to remove logo",severity:"error"})}},color:"error",sx:{mt:1},children:"Remove Logo"})]})]})]}),(0,z.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,z.jsx)(h.A,{sx:{my:1}}),(0,z.jsxs)(c.A,{variant:"subtitle1",sx:{mb:1,mt:.5,display:"flex",alignItems:"center",fontWeight:600},children:[(0,z.jsx)(W.A,{sx:{mr:.5,fontSize:20}}),"Basic Information"]})]}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Company Name",value:K.name,onChange:ee("name"),error:!!G.name,helperText:G.name,required:!0})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(u.A,{fullWidth:!0,size:"small",required:!0,error:!!G.type,children:[(0,z.jsx)(g.A,{children:"Company Type"}),(0,z.jsx)(A.A,{value:K.type,label:"Company Type",onChange:ee("type"),children:["investor","developer","brokerage","lender","contractor","property_management","legal_services","consulting","other"].map(e=>(0,z.jsx)(j.A,{value:e,children:e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())},e))}),G.type&&(0,z.jsx)(v.A,{children:G.type})]})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(u.A,{fullWidth:!0,size:"small",children:[(0,z.jsx)(g.A,{children:"Industry"}),(0,z.jsx)(A.A,{value:K.industry,label:"Industry",onChange:ee("industry"),children:["Real Estate Investment","Property Development","Commercial Brokerage","Property Management","Construction","Architecture","Legal Services","Financial Services","Consulting","Technology","Other"].map(e=>(0,z.jsx)(j.A,{value:e,children:e},e))})]})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(u.A,{fullWidth:!0,size:"small",children:[(0,z.jsx)(g.A,{children:"Company Size"}),(0,z.jsx)(A.A,{value:K.size,label:"Company Size",onChange:ee("size"),children:["1-10","11-50","51-200","201-1000","1000+"].map(e=>(0,z.jsxs)(j.A,{value:e,children:[e," employees"]},e))})]})}),(0,z.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,z.jsx)(h.A,{sx:{my:1}}),(0,z.jsxs)(c.A,{variant:"subtitle1",sx:{mb:1,mt:.5,display:"flex",alignItems:"center",fontWeight:600},children:[(0,z.jsx)(k.A,{sx:{mr:.5,fontSize:20}}),"Contact Information"]})]}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Email",type:"email",value:K.email,onChange:ee("email"),error:!!G.email,helperText:G.email})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Phone",value:K.phone,onChange:ee("phone")})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Website",value:K.website,onChange:ee("website"),placeholder:"https://example.com"})}),(0,z.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,z.jsx)(h.A,{sx:{my:1}}),(0,z.jsxs)(c.A,{variant:"subtitle1",sx:{mb:1,mt:.5,display:"flex",alignItems:"center",fontWeight:600},children:[(0,z.jsx)(B.A,{sx:{mr:.5,fontSize:20}}),"Address"]})]}),(0,z.jsx)(p.Ay,{item:!0,xs:12,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Street Address",value:K.address,onChange:ee("address")})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"City",value:K.city,onChange:ee("city")})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"State",value:K.state,onChange:ee("state")})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"ZIP Code",value:K.zipCode,onChange:ee("zipCode")})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,children:(0,z.jsx)(y.A,{fullWidth:!0,label:"Description",multiline:!0,rows:4,value:K.description,onChange:ee("description"),helperText:"Describe the company's business, specialties, and other relevant details"})}),(0,z.jsx)(p.Ay,{item:!0,xs:12,children:(0,z.jsxs)(r.A,{sx:{display:"flex",gap:1.5,justifyContent:"flex-end",mt:2},children:[(0,z.jsx)(l.A,{size:"small",variant:"outlined",onClick:ae,disabled:O,children:"Cancel"}),(0,z.jsx)(l.A,{size:"small",type:"submit",variant:"contained",startIcon:O?(0,z.jsx)(o.A,{size:16}):(0,z.jsx)(M.A,{}),disabled:O,children:O?"Saving...":C?"Update Company":"Create Company"})]})})]})})}),(0,z.jsx)(f.A,{open:R.open,autoHideDuration:6e3,onClose:()=>_((0,i.A)((0,i.A)({},R),{},{open:!1})),children:(0,z.jsx)(d.A,{onClose:()=>_((0,i.A)((0,i.A)({},R),{},{open:!1})),severity:R.severity,sx:{width:"100%"},children:R.message})})]})}},51387:(e,s,t)=>{t.d(s,{A:()=>n});var i=t(66734),a=t(70579);const n=(0,i.A)((0,a.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},66593:(e,s,t)=>{t.d(s,{Wl:()=>o,Yd:()=>c,aV:()=>l,w4:()=>n,zG:()=>r});var i=t(89379),a=t(41641);const n=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const t=(0,i.A)({maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,fileType:e.type,initialQuality:.8},s);if(e.size<=1024*t.maxSizeMB*1024)return e;console.log("Compressing image: ".concat(e.name," (").concat((e.size/1024/1024).toFixed(2),"MB)"));const n=await(0,a.A)(e,t);return console.log("Compressed image: ".concat(e.name," (").concat((n.size/1024/1024).toFixed(2),"MB)")),n}catch(t){return console.error("Error compressing image:",t),e}},r=(e,s)=>{const t={useWebWorker:!0,fileType:s};switch(e){case"avatar":case"logo":return(0,i.A)((0,i.A)({},t),{},{maxSizeMB:.5,maxWidthOrHeight:400,initialQuality:.9});case"property":return(0,i.A)((0,i.A)({},t),{},{maxSizeMB:2,maxWidthOrHeight:2048,initialQuality:.8});case"document":return(0,i.A)((0,i.A)({},t),{},{maxSizeMB:1,maxWidthOrHeight:1200,initialQuality:.7});default:return(0,i.A)((0,i.A)({},t),{},{maxSizeMB:1,maxWidthOrHeight:1920,initialQuality:.8})}},o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{maxSizeBytes:t=10485760,allowedTypes:i=["image/jpeg","image/jpg","image/png","image/gif","image/webp"]}=s,a=[];return i.includes(e.type)||a.push("Invalid file type. Allowed types: ".concat(i.join(", "))),e.size>t&&a.push("File size too large. Maximum size: ".concat((t/1024/1024).toFixed(1),"MB")),{isValid:0===a.length,errors:a}},l=e=>URL.createObjectURL(e),c=e=>{e&&e.startsWith("blob:")&&URL.revokeObjectURL(e)}}}]);
//# sourceMappingURL=8676.f0ecae09.chunk.js.map