"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[6724],{2081:(e,a,s)=>{s.d(a,{A:()=>r});var n=s(66734),t=s(70579);const r=(0,n.A)((0,t.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew")},13479:(e,a,s)=>{s.d(a,{A:()=>r});var n=s(66734),t=s(70579);const r=(0,n.A)((0,t.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Sync")},51387:(e,a,s)=>{s.d(a,{A:()=>r});var n=s(66734),t=s(70579);const r=(0,n.A)((0,t.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},79958:(e,a,s)=>{s.d(a,{A:()=>f});var n=s(98587),t=s(58168),r=s(65043),l=s(58387),i=s(98610),c=s(85865),o=s(98206),d=s(34535),x=s(92532),h=s(72372);function A(e){return(0,h.Ay)("MuiCardHeader",e)}const u=(0,x.A)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var m=s(70579);const v=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],j=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,a)=>(0,t.A)({["& .".concat(u.title)]:a.title,["& .".concat(u.subheader)]:a.subheader},a.root)})({display:"flex",alignItems:"center",padding:16}),y=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,a)=>a.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),p=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,a)=>a.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),g=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,a)=>a.content})({flex:"1 1 auto"}),f=r.forwardRef(function(e,a){const s=(0,o.b)({props:e,name:"MuiCardHeader"}),{action:r,avatar:d,className:x,component:h="div",disableTypography:u=!1,subheader:f,subheaderTypographyProps:b,title:C,titleTypographyProps:S}=s,w=(0,n.A)(s,v),I=(0,t.A)({},s,{component:h,disableTypography:u}),F=(e=>{const{classes:a}=e;return(0,i.A)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},A,a)})(I);let N=C;null==N||N.type===c.A||u||(N=(0,m.jsx)(c.A,(0,t.A)({variant:d?"body2":"h5",className:F.title,component:"span",display:"block"},S,{children:N})));let z=f;return null==z||z.type===c.A||u||(z=(0,m.jsx)(c.A,(0,t.A)({variant:d?"body2":"body1",className:F.subheader,color:"text.secondary",component:"span",display:"block"},b,{children:z}))),(0,m.jsxs)(j,(0,t.A)({className:(0,l.A)(F.root,x),as:h,ref:a,ownerState:I},w,{children:[d&&(0,m.jsx)(y,{className:F.avatar,ownerState:I,children:d}),(0,m.jsxs)(g,{className:F.content,ownerState:I,children:[N,z]}),r&&(0,m.jsx)(p,{className:F.action,ownerState:I,children:r})]}))})},91794:(e,a,s)=>{s.d(a,{A:()=>r});var n=s(66734),t=s(70579);const r=(0,n.A)((0,t.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")},96724:(e,a,s)=>{s.r(a),s.d(a,{default:()=>U});var n=s(65043),t=s(73216),r=s(96446),l=s(81637),i=s(85865),c=s(11906),o=s(67254),d=s(68903),x=s(12110),h=s(79958),A=s(26494),u=s(43845),m=s(35721),v=s(24628),j=s(48734),y=s(8266),p=s(77739),g=s(17392),f=s(83462),b=s(26600),C=s(35316),S=s(67784),w=s(29347),I=s(47805),F=s(48262),N=s(98606),z=s(91794),H=s(95874),D=s(47225),E=s(71991),M=s(33390),k=s(13479),R=s(51387),T=s(58602),L=s(2081),V=s(66734),P=s(70579);const _=(0,V.A)((0,P.jsx)("path",{d:"M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6z"}),"Flag"),B=(0,V.A)((0,P.jsx)("path",{d:"M10.5 13H8v-3h2.5V7.5h3V10H16v3h-2.5v2.5h-3zM12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5z"}),"HealthAndSafety");var G=s(20404),O=s(8411),W=s(35016);const U=()=>{var e,a,s,V,U,K,Y,Z,q,J,Q,X,$;const{user:ee}=(0,W.h)(),ae=(0,t.Zp)(),[se,ne]=(0,n.useState)(!0),[te,re]=(0,n.useState)(null),[le,ie]=(0,n.useState)([]),[ce,oe]=(0,n.useState)(null),[de,xe]=(0,n.useState)(null),[he,Ae]=(0,n.useState)(null),[ue,me]=(0,n.useState)(!1),[ve,je]=(0,n.useState)(""),[ye,pe]=(0,n.useState)(!1),ge="admin"===(null===ee||void 0===ee?void 0:ee.role);(0,n.useEffect)(()=>{fe()},[]);const fe=async()=>{try{var e;ne(!0),Ae(null);const[a,s,n,t]=await Promise.all([G.A.getSendGridStatus().catch(()=>null),O.A.getAccounts().catch(()=>({data:{accounts:[]}})),ge?G.A.getSystemHealth().catch(()=>null):Promise.resolve(null),ge?G.A.getFeatureFlags().catch(()=>null):Promise.resolve(null)]);re(a),ie((null===(e=s.data)||void 0===e?void 0:e.accounts)||[]),oe(n),xe(t)}catch(a){Ae("Failed to load integration data"),console.error(a)}finally{ne(!1)}},be=async e=>{try{const{data:a}=await O.A.getConnectUrl(e),s=window.open(a.authUrl,"Calendar Connection","width=600,height=700"),n=a=>{"calendar-connected"===a.data.type?(s.close(),fe(),alert("".concat("google"===e?"Google":"Microsoft"," Calendar connected successfully!"))):"calendar-error"===a.data.type&&alert("Failed to connect calendar: "+a.data.error)};window.addEventListener("message",n);const t=setInterval(()=>{s.closed&&(clearInterval(t),window.removeEventListener("message",n))},500)}catch(n){var a,s;alert("Failed to initiate calendar connection: "+((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||n.message))}};return se?(0,P.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:(0,P.jsx)(l.A,{})}):(0,P.jsxs)(r.A,{children:[(0,P.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,P.jsx)(i.A,{variant:"h4",sx:{fontWeight:700},children:"Integrations"}),(0,P.jsx)(c.A,{startIcon:(0,P.jsx)(I.A,{}),onClick:fe,variant:"outlined",children:"Refresh"})]}),he&&(0,P.jsx)(o.A,{severity:"error",sx:{mb:3},onClose:()=>Ae(null),children:he}),(0,P.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsxs)(x.A,{children:[(0,P.jsx)(h.A,{avatar:(0,P.jsx)(F.A,{color:"primary"}),title:"SendGrid Email",subheader:"Transactional email service"}),(0,P.jsx)(A.A,{children:te?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(r.A,{display:"flex",alignItems:"center",mb:2,children:[(0,P.jsx)(i.A,{variant:"body2",sx:{mr:1},children:"Status:"}),(0,P.jsx)(u.A,{label:te.configured?"Connected":"Not Configured",color:te.configured?"success":"warning",size:"small",icon:te.configured?(0,P.jsx)(N.A,{}):(0,P.jsx)(z.A,{})})]}),te.configured&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(i.A,{variant:"body2",sx:{mb:1},children:[(0,P.jsx)("strong",{children:"From Email:"})," ",te.fromEmail||"Not set"]}),(0,P.jsxs)(i.A,{variant:"body2",sx:{mb:1},children:[(0,P.jsx)("strong",{children:"From Name:"})," ",te.fromName||"Not set"]}),(0,P.jsxs)(i.A,{variant:"body2",sx:{mb:2},children:[(0,P.jsx)("strong",{children:"Templates Configured:"})," ",Object.values(te.templates||{}).filter(Boolean).length," / 3"]}),(0,P.jsx)(c.A,{variant:"contained",startIcon:(0,P.jsx)(H.A,{}),onClick:()=>me(!0),fullWidth:!0,children:"Send Test Email"})]}),!te.configured&&(0,P.jsx)(o.A,{severity:"info",sx:{mt:2},children:"Configure SendGrid by setting SENDGRID_API_KEY in your environment variables."})]}):(0,P.jsx)(o.A,{severity:"warning",children:"Failed to load SendGrid status"})})]})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsxs)(x.A,{children:[(0,P.jsx)(h.A,{avatar:(0,P.jsx)(D.A,{color:"primary"}),title:"Calendar Integrations",subheader:"".concat(le.length," account(s) connected")}),(0,P.jsxs)(A.A,{children:[le.length>0?(0,P.jsx)(m.A,{dense:!0,children:le.map(e=>(0,P.jsxs)(v.Ay,{divider:!0,children:[(0,P.jsx)(j.A,{primary:(0,P.jsxs)(r.A,{display:"flex",alignItems:"center",gap:1,children:["google"===e.provider?(0,P.jsx)(E.A,{fontSize:"small"}):(0,P.jsx)(M.A,{fontSize:"small"}),(0,P.jsx)(i.A,{variant:"body2",children:e.email})]}),secondary:(0,P.jsxs)(r.A,{children:[(0,P.jsxs)(i.A,{variant:"caption",display:"block",children:["Last synced: ",e.lastSyncedAt?new Date(e.lastSyncedAt).toLocaleString():"Never"]}),(0,P.jsx)(u.A,{label:e.isActive?"Active":"Inactive",size:"small",color:e.isActive?"success":"default",sx:{mt:.5}})]})}),(0,P.jsxs)(y.A,{children:[(0,P.jsx)(p.A,{title:"Sync Now",children:(0,P.jsx)(g.A,{edge:"end",size:"small",onClick:()=>(async e=>{try{await O.A.syncAccount(e),alert("Calendar synced successfully"),fe()}catch(n){var a,s;alert("Failed to sync calendar: "+((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||n.message))}})(e.id),sx:{mr:1},children:(0,P.jsx)(k.A,{fontSize:"small"})})}),(0,P.jsx)(p.A,{title:"Disconnect",children:(0,P.jsx)(g.A,{edge:"end",size:"small",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to disconnect this calendar?"))try{await O.A.disconnectAccount(e),alert("Calendar disconnected successfully"),fe()}catch(n){var a,s;alert("Failed to disconnect calendar: "+((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||n.message))}})(e.id),color:"error",children:(0,P.jsx)(R.A,{fontSize:"small"})})})]})]},e.id))}):(0,P.jsx)(o.A,{severity:"info",sx:{mb:2},children:"No calendar accounts connected"}),(0,P.jsxs)(r.A,{display:"flex",gap:1,mt:2,children:[(0,P.jsx)(c.A,{variant:"outlined",startIcon:(0,P.jsx)(E.A,{}),onClick:()=>be("google"),fullWidth:!0,children:"Connect Google"}),(0,P.jsx)(c.A,{variant:"outlined",startIcon:(0,P.jsx)(M.A,{}),onClick:()=>be("microsoft"),fullWidth:!0,children:"Connect Microsoft"})]})]})]})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsxs)(x.A,{children:[(0,P.jsx)(h.A,{avatar:(0,P.jsx)(T.A,{color:"primary"}),title:"Dashboards & Reports",subheader:"Custom dashboards and widgets"}),(0,P.jsxs)(A.A,{children:[(0,P.jsxs)(r.A,{display:"flex",alignItems:"center",mb:2,children:[(0,P.jsx)(i.A,{variant:"body2",sx:{mr:1},children:"Feature Status:"}),(0,P.jsx)(u.A,{label:null!==de&&void 0!==de&&null!==(e=de.data)&&void 0!==e&&e.DASHBOARDS_ENABLED?"Enabled":"Disabled",color:null!==de&&void 0!==de&&null!==(a=de.data)&&void 0!==a&&a.DASHBOARDS_ENABLED?"success":"warning",size:"small",icon:null!==de&&void 0!==de&&null!==(s=de.data)&&void 0!==s&&s.DASHBOARDS_ENABLED?(0,P.jsx)(N.A,{}):(0,P.jsx)(z.A,{})})]}),(0,P.jsx)(i.A,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"Create custom dashboards with real-time metrics and visualizations"}),(0,P.jsx)(c.A,{variant:"contained",endIcon:(0,P.jsx)(L.A,{}),onClick:()=>ae("/dashboards"),fullWidth:!0,children:"Go to Dashboards"})]})]})}),ge&&de&&(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsxs)(x.A,{children:[(0,P.jsx)(h.A,{avatar:(0,P.jsx)(_,{color:"primary"}),title:"Feature Flags",subheader:"System feature toggles (read-only)"}),(0,P.jsxs)(A.A,{children:[(0,P.jsx)(m.A,{dense:!0,children:Object.entries(de.data||{}).map(e=>{let[a,s]=e;return(0,P.jsxs)(v.Ay,{children:[(0,P.jsx)(j.A,{primary:a.replace(/_/g," "),secondary:"Configured in environment variables"}),(0,P.jsx)(u.A,{label:s?"Enabled":"Disabled",color:s?"success":"default",size:"small",icon:s?(0,P.jsx)(N.A,{}):(0,P.jsx)(z.A,{})})]},a)})}),(0,P.jsx)(o.A,{severity:"info",sx:{mt:2},children:"Feature flags can only be changed via environment variables (.env file)"})]})]})}),ge&&ce&&(0,P.jsx)(d.Ay,{item:!0,xs:12,children:(0,P.jsxs)(x.A,{children:[(0,P.jsx)(h.A,{avatar:(0,P.jsx)(B,{color:"primary"}),title:"System Health",subheader:"API and infrastructure status"}),(0,P.jsx)(A.A,{children:(0,P.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:4,children:(0,P.jsxs)(r.A,{textAlign:"center",p:2,children:[(0,P.jsx)(i.A,{variant:"caption",color:"text.secondary",children:"API Server"}),(0,P.jsxs)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",mt:1,children:[(0,P.jsx)(N.A,{color:"success",sx:{mr:1}}),(0,P.jsx)(i.A,{variant:"h6",children:"Operational"})]}),(0,P.jsxs)(i.A,{variant:"caption",color:"text.secondary",children:["Uptime: ",Math.floor((null===(V=ce.data)||void 0===V||null===(U=V.api)||void 0===U?void 0:U.uptime)||0),"s"]})]})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:4,children:(0,P.jsxs)(r.A,{textAlign:"center",p:2,children:[(0,P.jsx)(i.A,{variant:"caption",color:"text.secondary",children:"Database"}),(0,P.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",mt:1,children:null!==(K=ce.data)&&void 0!==K&&null!==(Y=K.database)&&void 0!==Y&&Y.connected?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(N.A,{color:"success",sx:{mr:1}}),(0,P.jsx)(i.A,{variant:"h6",children:"Connected"})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(z.A,{color:"error",sx:{mr:1}}),(0,P.jsx)(i.A,{variant:"h6",children:"Disconnected"})]})}),(0,P.jsx)(i.A,{variant:"caption",color:"text.secondary",children:(null===(Z=ce.data)||void 0===Z||null===(q=Z.database)||void 0===q?void 0:q.status)||"Unknown"})]})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:4,children:(0,P.jsxs)(r.A,{textAlign:"center",p:2,children:[(0,P.jsx)(i.A,{variant:"caption",color:"text.secondary",children:"Redis Cache"}),(0,P.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",mt:1,children:null!==(J=ce.data)&&void 0!==J&&null!==(Q=J.redis)&&void 0!==Q&&Q.connected?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(N.A,{color:"success",sx:{mr:1}}),(0,P.jsx)(i.A,{variant:"h6",children:"Connected"})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(z.A,{color:"warning",sx:{mr:1}}),(0,P.jsx)(i.A,{variant:"h6",children:"Not Configured"})]})}),(0,P.jsx)(i.A,{variant:"caption",color:"text.secondary",children:(null===(X=ce.data)||void 0===X||null===($=X.redis)||void 0===$?void 0:$.status)||"Optional"})]})})]})})]})})]}),(0,P.jsxs)(f.A,{open:ue,onClose:()=>me(!1),maxWidth:"sm",fullWidth:!0,children:[(0,P.jsx)(b.A,{children:"Send Test Email"}),(0,P.jsx)(C.A,{children:(0,P.jsx)(S.A,{autoFocus:!0,margin:"dense",label:"Recipient Email",type:"email",fullWidth:!0,value:ve,onChange:e=>je(e.target.value),placeholder:"email@example.com"})}),(0,P.jsxs)(w.A,{children:[(0,P.jsx)(c.A,{onClick:()=>me(!1),children:"Cancel"}),(0,P.jsx)(c.A,{onClick:async()=>{try{pe(!0),await G.A.sendTestEmail(ve),alert("Test email sent successfully!"),me(!1),je("")}catch(s){var e,a;alert("Failed to send test email: "+((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.error)||s.message))}finally{pe(!1)}},variant:"contained",disabled:!ve||ye,startIcon:ye?(0,P.jsx)(l.A,{size:20}):(0,P.jsx)(H.A,{}),children:"Send"})]})]})]})}}}]);
//# sourceMappingURL=6724.f92e1c5e.chunk.js.map