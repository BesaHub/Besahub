"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[5738],{55738:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ne});var i=s(89379),a=s(65043),n=s(12110),r=s(26494),l=s(96446),o=s(85865),c=s(81045),d=s(81637),x=s(67254),h=s(68903),A=s(63336),m=s(29013),u=s(24056),j=s(42796),p=s(42263),g=s(75155),y=s(67957),v=s(59275),f=s(84770),S=s(93234),b=s(79558),z=s(812),w=s(94505),C=s(11906),I=s(67784),k=s(53193),W=s(18356),U=s(72221),B=s(32143),D=s(79650),F=s(71806),N=s(84882),P=s(28076),T=s(10039),R=s(73460),L=s(43845),E=s(17392),M=s(94109),H=s(35721),V=s(24628),_=s(48734),O=s(70141),q=s(83560),$=s(33438),K=s(79722),Y=s(70579);const G=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)([]),[r,c]=(0,a.useState)([]),[h,m]=(0,a.useState)(!0),[u,j]=(0,a.useState)(""),[p,g]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1),[f,S]=(0,a.useState)(!1),[b,z]=(0,a.useState)({role:"all",status:"all",search:""});(0,a.useEffect)(()=>{w(),G(),J()},[b]);const w=async()=>{try{m(!0);const e=localStorage.getItem("token"),s=await K.A.get("/api/admin/users",{headers:{Authorization:"Bearer ".concat(e)},params:b});t(s.data.users),j("")}catch(e){j("Failed to load users"),console.error(e)}finally{m(!1)}},G=async()=>{try{const e=localStorage.getItem("token"),t=await K.A.get("/api/admin/roles",{headers:{Authorization:"Bearer ".concat(e)}});n(t.data.roles)}catch(e){console.error("Failed to load roles",e)}},J=async()=>{try{const e=localStorage.getItem("token"),t=await K.A.get("/api/admin/teams",{headers:{Authorization:"Bearer ".concat(e)}});c(t.data.teams)}catch(e){console.error("Failed to load teams",e)}};return h?(0,Y.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,Y.jsx)(d.A,{})}):(0,Y.jsxs)(l.A,{children:[(0,Y.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,Y.jsx)(o.A,{variant:"h5",children:"User Management"}),(0,Y.jsx)(C.A,{variant:"contained",color:"primary",startIcon:(0,Y.jsx)(O.A,{}),onClick:()=>S(!0),children:"Add User"})]}),u&&(0,Y.jsx)(x.A,{severity:"error",sx:{mb:2},children:u}),(0,Y.jsxs)(l.A,{display:"flex",gap:2,mb:3,children:[(0,Y.jsx)(I.A,{label:"Search",variant:"outlined",size:"small",value:b.search,onChange:e=>z((0,i.A)((0,i.A)({},b),{},{search:e.target.value})),sx:{width:300}}),(0,Y.jsxs)(k.A,{size:"small",sx:{minWidth:150},children:[(0,Y.jsx)(W.A,{children:"Role"}),(0,Y.jsxs)(U.A,{value:b.role,label:"Role",onChange:e=>z((0,i.A)((0,i.A)({},b),{},{role:e.target.value})),children:[(0,Y.jsx)(B.A,{value:"all",children:"All Roles"}),(0,Y.jsx)(B.A,{value:"admin",children:"Admin"}),(0,Y.jsx)(B.A,{value:"manager",children:"Manager"}),(0,Y.jsx)(B.A,{value:"agent",children:"Agent"}),(0,Y.jsx)(B.A,{value:"assistant",children:"Assistant"})]})]}),(0,Y.jsxs)(k.A,{size:"small",sx:{minWidth:150},children:[(0,Y.jsx)(W.A,{children:"Status"}),(0,Y.jsxs)(U.A,{value:b.status,label:"Status",onChange:e=>z((0,i.A)((0,i.A)({},b),{},{status:e.target.value})),children:[(0,Y.jsx)(B.A,{value:"all",children:"All Status"}),(0,Y.jsx)(B.A,{value:"active",children:"Active"}),(0,Y.jsx)(B.A,{value:"inactive",children:"Inactive"})]})]})]}),(0,Y.jsx)(D.A,{component:A.A,children:(0,Y.jsxs)(F.A,{children:[(0,Y.jsx)(N.A,{children:(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{children:"Name"}),(0,Y.jsx)(T.A,{children:"Email"}),(0,Y.jsx)(T.A,{children:"Role"}),(0,Y.jsx)(T.A,{children:"Status"}),(0,Y.jsx)(T.A,{children:"Last Login"}),(0,Y.jsx)(T.A,{children:"Actions"})]})}),(0,Y.jsx)(R.A,{children:e.map(e=>{return(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{children:"".concat(e.firstName," ").concat(e.lastName)}),(0,Y.jsx)(T.A,{children:e.email}),(0,Y.jsx)(T.A,{children:(0,Y.jsx)(L.A,{label:e.role,size:"small",color:"primary"})}),(0,Y.jsx)(T.A,{children:(0,Y.jsx)(L.A,{label:e.isActive?"Active":"Inactive",size:"small",color:(t=e.isActive,t?"success":"default")})}),(0,Y.jsx)(T.A,{children:e.lastLogin?new Date(e.lastLogin).toLocaleDateString():"Never"}),(0,Y.jsx)(T.A,{children:(0,Y.jsx)(E.A,{size:"small",onClick:()=>(e=>{g(e),v(!0)})(e),children:(0,Y.jsx)(q.A,{})})})]},e.id);var t})})]})}),(0,Y.jsx)(M.Ay,{anchor:"right",open:y,onClose:()=>v(!1),sx:{"& .MuiDrawer-paper":{width:500,p:3}},children:p&&(0,Y.jsxs)(l.A,{children:[(0,Y.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,Y.jsx)(o.A,{variant:"h6",children:"".concat(p.firstName," ").concat(p.lastName)}),(0,Y.jsx)(E.A,{onClick:()=>v(!1),children:(0,Y.jsx)($.A,{})})]}),(0,Y.jsxs)(o.A,{variant:"subtitle2",gutterBottom:!0,children:["Email: ",p.email]}),(0,Y.jsxs)(o.A,{variant:"subtitle2",gutterBottom:!0,children:["Current Role: ",p.role]}),(0,Y.jsxs)(l.A,{mt:4,children:[(0,Y.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Assign Role"}),(0,Y.jsx)(H.A,{children:s.map(e=>(0,Y.jsx)(V.Ay,{button:!0,onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token");await K.A.post("/api/admin/users/".concat(e,"/roles"),{roleId:t},{headers:{Authorization:"Bearer ".concat(s)}}),w(),j(""),alert("Role assigned successfully")}catch(s){j("Failed to assign role"),console.error(s)}})(p.id,e.id),children:(0,Y.jsx)(_.A,{primary:e.name,secondary:e.description})},e.id))})]}),(0,Y.jsxs)(l.A,{mt:4,children:[(0,Y.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Assign Team"}),(0,Y.jsx)(H.A,{children:r.map(e=>(0,Y.jsx)(V.Ay,{button:!0,onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token");await K.A.post("/api/admin/users/".concat(e,"/teams"),{teamId:t},{headers:{Authorization:"Bearer ".concat(s)}}),w(),j(""),alert("Team assigned successfully")}catch(s){j("Failed to assign team"),console.error(s)}})(p.id,e.id),children:(0,Y.jsx)(_.A,{primary:e.name,secondary:e.description})},e.id))})]}),(0,Y.jsx)(l.A,{mt:4,children:(0,Y.jsx)(C.A,{variant:"contained",color:p.isActive?"error":"success",fullWidth:!0,onClick:()=>(async(e,t)=>{try{const s=localStorage.getItem("token");await K.A.put("/api/admin/users/".concat(e),t,{headers:{Authorization:"Bearer ".concat(s)}}),w(),j(""),alert("User updated successfully")}catch(s){j("Failed to update user"),console.error(s)}})(p.id,{isActive:!p.isActive}),children:p.isActive?"Deactivate User":"Activate User"})})]})})]})};var J=s(83462),Q=s(26600),X=s(35316),Z=s(29347),ee=s(51387);const te=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[r,c]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[u,j]=(0,a.useState)(null),[p,y]=(0,a.useState)({name:"",description:"",leaderId:"",parentTeamId:""});(0,a.useEffect)(()=>{v()},[]);const v=async()=>{try{n(!0);const e=localStorage.getItem("token"),s=await K.A.get("/api/admin/teams",{headers:{Authorization:"Bearer ".concat(e)}});t(s.data.teams),c("")}catch(e){c("Failed to load teams"),console.error(e)}finally{n(!1)}},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(j(e),y({name:e.name,description:e.description||"",leaderId:e.leaderId||"",parentTeamId:e.parentTeamId||""})):(j(null),y({name:"",description:"",leaderId:"",parentTeamId:""})),m(!0)},S=()=>{m(!1),j(null),y({name:"",description:"",leaderId:"",parentTeamId:""})};return s?(0,Y.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,Y.jsx)(d.A,{})}):(0,Y.jsxs)(l.A,{children:[(0,Y.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,Y.jsx)(o.A,{variant:"h5",children:"Team Management"}),(0,Y.jsx)(C.A,{variant:"contained",color:"primary",startIcon:(0,Y.jsx)(O.A,{}),onClick:()=>f(),children:"Add Team"})]}),r&&(0,Y.jsx)(x.A,{severity:"error",sx:{mb:2},children:r}),(0,Y.jsx)(D.A,{component:A.A,children:(0,Y.jsxs)(F.A,{size:"small",children:[(0,Y.jsx)(N.A,{children:(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Name"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Description"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Leader"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Members"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Status"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Actions"})]})}),(0,Y.jsx)(R.A,{children:e.map(e=>{var t;return(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem"},children:e.name}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem"},children:e.description}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem"},children:e.leader?"".concat(e.leader.firstName," ").concat(e.leader.lastName):"N/A"}),(0,Y.jsx)(T.A,{sx:{py:.75},children:(0,Y.jsx)(L.A,{icon:(0,Y.jsx)(g.A,{sx:{fontSize:14}}),label:(null===(t=e.members)||void 0===t?void 0:t.length)||0,size:"small",color:"primary",sx:{height:20,fontSize:"0.688rem"}})}),(0,Y.jsx)(T.A,{sx:{py:.75},children:(0,Y.jsx)(L.A,{label:e.isActive?"Active":"Inactive",size:"small",color:e.isActive?"success":"default",sx:{height:20,fontSize:"0.688rem"}})}),(0,Y.jsxs)(T.A,{sx:{py:.75},children:[(0,Y.jsx)(E.A,{size:"small",onClick:()=>f(e),sx:{p:.5},children:(0,Y.jsx)(q.A,{sx:{fontSize:16}})}),(0,Y.jsx)(E.A,{size:"small",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this team?"))try{const t=localStorage.getItem("token");await K.A.delete("/api/admin/teams/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),v(),c("")}catch(t){c("Failed to delete team"),console.error(t)}})(e.id),sx:{p:.5},children:(0,Y.jsx)(ee.A,{sx:{fontSize:16}})})]})]},e.id)})})]})}),(0,Y.jsxs)(J.A,{open:h,onClose:S,maxWidth:"sm",fullWidth:!0,children:[(0,Y.jsx)(Q.A,{children:u?"Edit Team":"Add Team"}),(0,Y.jsx)(X.A,{children:(0,Y.jsxs)(l.A,{display:"flex",flexDirection:"column",gap:2,mt:2,children:[(0,Y.jsx)(I.A,{label:"Team Name",fullWidth:!0,value:p.name,onChange:e=>y((0,i.A)((0,i.A)({},p),{},{name:e.target.value})),required:!0}),(0,Y.jsx)(I.A,{label:"Description",fullWidth:!0,multiline:!0,rows:3,value:p.description,onChange:e=>y((0,i.A)((0,i.A)({},p),{},{description:e.target.value}))})]})}),(0,Y.jsxs)(Z.A,{children:[(0,Y.jsx)(C.A,{onClick:S,children:"Cancel"}),(0,Y.jsx)(C.A,{onClick:async()=>{try{const e=localStorage.getItem("token");u?await K.A.put("/api/admin/teams/".concat(u.id),p,{headers:{Authorization:"Bearer ".concat(e)}}):await K.A.post("/api/admin/teams",p,{headers:{Authorization:"Bearer ".concat(e)}}),v(),S(),c("")}catch(e){c("Failed to save team"),console.error(e)}},variant:"contained",color:"primary",children:"Save"})]})]})]})};var se=s(74605),ie=s(51962);const ae=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)([]),[r,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(""),[j,p]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1),[v,f]=(0,a.useState)(null),[b,z]=(0,a.useState)(null),[w,k]=(0,a.useState)({name:"",description:""});(0,a.useEffect)(()=>{W(),U()},[]);const W=async()=>{try{c(!0);const e=localStorage.getItem("token"),s=await K.A.get("/api/admin/roles",{headers:{Authorization:"Bearer ".concat(e)}});t(s.data.roles),u("")}catch(e){u("Failed to load roles"),console.error(e)}finally{c(!1)}},U=async()=>{try{const e=localStorage.getItem("token"),t=await K.A.get("/api/admin/permissions",{headers:{Authorization:"Bearer ".concat(e)}});n(t.data.permissions)}catch(e){console.error("Failed to load permissions",e)}},B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(f(e),k({name:e.name,description:e.description||""})):(f(null),k({name:"",description:""})),p(!0)},M=()=>{p(!1),f(null),k({name:"",description:""})},H=()=>{y(!1),z(null)};return r?(0,Y.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,Y.jsx)(d.A,{})}):(0,Y.jsxs)(l.A,{children:[(0,Y.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,Y.jsx)(o.A,{variant:"h5",children:"Role Management"}),(0,Y.jsx)(C.A,{variant:"contained",color:"primary",startIcon:(0,Y.jsx)(O.A,{}),onClick:()=>B(),children:"Add Role"})]}),m&&(0,Y.jsx)(x.A,{severity:"error",sx:{mb:2},children:m}),(0,Y.jsx)(D.A,{component:A.A,children:(0,Y.jsxs)(F.A,{size:"small",children:[(0,Y.jsx)(N.A,{children:(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Name"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Description"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Permissions"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"System Role"}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem",fontWeight:600},children:"Actions"})]})}),(0,Y.jsx)(R.A,{children:e.map(e=>{var t;return(0,Y.jsxs)(P.A,{children:[(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem"},children:e.name}),(0,Y.jsx)(T.A,{sx:{py:.75,fontSize:"0.813rem"},children:e.description}),(0,Y.jsx)(T.A,{sx:{py:.75},children:(0,Y.jsx)(L.A,{icon:(0,Y.jsx)(S.A,{sx:{fontSize:14}}),label:(null===(t=e.permissions)||void 0===t?void 0:t.length)||0,size:"small",color:"primary",sx:{height:20,fontSize:"0.688rem"}})}),(0,Y.jsx)(T.A,{sx:{py:.75},children:(0,Y.jsx)(L.A,{label:e.isSystem?"Yes":"No",size:"small",color:e.isSystem?"warning":"default",sx:{height:20,fontSize:"0.688rem"}})}),(0,Y.jsxs)(T.A,{sx:{py:.75},children:[(0,Y.jsx)(E.A,{size:"small",onClick:()=>(e=>{z(e),y(!0)})(e),title:"Manage Permissions",sx:{p:.5},children:(0,Y.jsx)(S.A,{sx:{fontSize:16}})}),!e.isSystem&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(E.A,{size:"small",onClick:()=>B(e),sx:{p:.5},children:(0,Y.jsx)(q.A,{sx:{fontSize:16}})}),(0,Y.jsx)(E.A,{size:"small",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this role?"))try{const t=localStorage.getItem("token");await K.A.delete("/api/admin/roles/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),W(),u("")}catch(t){u("Failed to delete role"),console.error(t)}})(e.id),sx:{p:.5},children:(0,Y.jsx)(ee.A,{sx:{fontSize:16}})})]})]})]},e.id)})})]})}),(0,Y.jsxs)(J.A,{open:j,onClose:M,maxWidth:"sm",fullWidth:!0,children:[(0,Y.jsx)(Q.A,{children:v?"Edit Role":"Add Role"}),(0,Y.jsx)(X.A,{children:(0,Y.jsxs)(l.A,{display:"flex",flexDirection:"column",gap:2,mt:2,children:[(0,Y.jsx)(I.A,{label:"Role Name",fullWidth:!0,value:w.name,onChange:e=>k((0,i.A)((0,i.A)({},w),{},{name:e.target.value})),required:!0}),(0,Y.jsx)(I.A,{label:"Description",fullWidth:!0,multiline:!0,rows:3,value:w.description,onChange:e=>k((0,i.A)((0,i.A)({},w),{},{description:e.target.value}))})]})}),(0,Y.jsxs)(Z.A,{children:[(0,Y.jsx)(C.A,{onClick:M,children:"Cancel"}),(0,Y.jsx)(C.A,{onClick:async()=>{try{const e=localStorage.getItem("token");v?await K.A.put("/api/admin/roles/".concat(v.id),w,{headers:{Authorization:"Bearer ".concat(e)}}):await K.A.post("/api/admin/roles",w,{headers:{Authorization:"Bearer ".concat(e)}}),W(),M(),u("")}catch(e){u("Failed to save role"),console.error(e)}},variant:"contained",color:"primary",children:"Save"})]})]}),(0,Y.jsxs)(J.A,{open:g,onClose:H,maxWidth:"md",fullWidth:!0,children:[(0,Y.jsxs)(Q.A,{children:["Manage Permissions - ",null===b||void 0===b?void 0:b.name]}),(0,Y.jsx)(X.A,{children:(0,Y.jsx)(l.A,{mt:2,children:Object.entries((()=>{const e={};return s.forEach(t=>{e[t.resource]||(e[t.resource]=[]),e[t.resource].push(t)}),e})()).map(e=>{let[t,s]=e;return(0,Y.jsxs)(l.A,{mb:3,children:[(0,Y.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:t.charAt(0).toUpperCase()+t.slice(1)}),(0,Y.jsx)(h.Ay,{container:!0,spacing:2,children:s.map(e=>{var t;return(0,Y.jsx)(h.Ay,{item:!0,xs:6,sm:4,children:(0,Y.jsx)(se.A,{control:(0,Y.jsx)(ie.A,{checked:null===b||void 0===b||null===(t=b.permissions)||void 0===t?void 0:t.some(t=>t.id===e.id),onChange:()=>(async e=>{if(b)try{var t;const s=localStorage.getItem("token");(null===(t=b.permissions)||void 0===t?void 0:t.some(t=>t.id===e))?await K.A.delete("/api/admin/roles/".concat(b.id,"/permissions/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}}):await K.A.post("/api/admin/roles/".concat(b.id,"/permissions"),{permissionId:e},{headers:{Authorization:"Bearer ".concat(s)}}),W(),u("")}catch(s){u("Failed to update permissions"),console.error(s)}})(e.id)}),label:e.action})},e.id)})})]},t)})})}),(0,Y.jsx)(Z.A,{children:(0,Y.jsx)(C.A,{onClick:H,variant:"contained",children:"Close"})})]})]})},ne=()=>{const[e,t]=(0,a.useState)(!0),[s,i]=(0,a.useState)(null),[C,I]=(0,a.useState)(0),[k,W]=(0,a.useState)(null),[U,B]=(0,a.useState)([]),[D,F]=(0,a.useState)(null),[N,P]=(0,a.useState)(!1),[T,R]=(0,a.useState)({});(0,a.useEffect)(()=>{L()},[]);const L=async()=>{try{var e,a,n,r,l,o;t(!0),i(null);let s={},d=[];try{const e=await w.ic.getOverview();s=e.data||e,d=s.users||[]}catch(c){console.warn("Admin API not accessible, using fallback data:",c);const[e,t]=await Promise.all([w.HN.getOverview().catch(()=>({data:null})),w.i$.getAll().catch(()=>({data:[]}))]);s=e.data||{},d=Array.isArray(t.data)?t.data:Array.isArray(t)?t:[]}W(s),B(d);const x={totalUsers:d.length,activeUsers:d.filter(e=>e.isActive).length,adminUsers:d.filter(e=>"admin"===e.role).length,agentUsers:d.filter(e=>"agent"===e.role).length,managerUsers:d.filter(e=>"manager"===e.role).length,recentLogins:d.filter(e=>{const t=new Date;return t.setDate(t.getDate()-7),e.lastLogin&&new Date(e.lastLogin)>t}).length,totalProperties:(null===(e=s.properties)||void 0===e||null===(a=e.inventoryStats)||void 0===a?void 0:a.totalProperties)||0,totalDeals:(null===(n=s.pipeline)||void 0===n||null===(r=n.totalPipeline)||void 0===r?void 0:r.reduce((e,t)=>e+(parseInt(t.count)||0),0))||0,pipelineValue:(null===(l=s.pipeline)||void 0===l||null===(o=l.totalPipeline)||void 0===o?void 0:o.reduce((e,t)=>e+(parseFloat(t.totalValue)||0),0))||0};R(x)}catch(s){console.error("Admin dashboard error:",s),i("Failed to load admin dashboard data"),B([{id:"1",firstName:"Demo",lastName:"Admin",email:"admin@demo.com",role:"admin",isActive:!0,lastLogin:new Date,createdAt:new Date}]),R({totalUsers:1,activeUsers:1,adminUsers:1,agentUsers:0,managerUsers:0,recentLogins:1,totalProperties:3,totalDeals:0,pipelineValue:0})}finally{t(!1)}},E=e=>{let{title:t,value:s,icon:i,color:a,subtitle:d,trend:x}=e;return(0,Y.jsx)(n.A,{className:"admin-stat-card",sx:{height:"100%"},children:(0,Y.jsxs)(r.A,{children:[(0,Y.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,Y.jsxs)(l.A,{children:[(0,Y.jsx)(o.A,{variant:"h3",sx:{fontWeight:700,color:a,mb:.5},children:s}),(0,Y.jsx)(o.A,{variant:"body1",color:"textSecondary",sx:{fontWeight:500},children:t}),d&&(0,Y.jsx)(o.A,{variant:"caption",color:"textSecondary",children:d})]}),(0,Y.jsx)(c.A,{sx:{bgcolor:"".concat(a,"20"),color:a,width:56,height:56},children:i})]}),x&&(0,Y.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,Y.jsx)(j.A,{sx:{fontSize:16,color:"success.main"}}),(0,Y.jsx)(o.A,{variant:"caption",color:"success.main",children:x})]})]})})},M=e=>{let{children:t,value:s,index:i}=e;return(0,Y.jsx)("div",{hidden:s!==i,style:{paddingTop:16},children:s===i&&t})};return e?(0,Y.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,Y.jsx)(d.A,{})}):(0,Y.jsxs)(l.A,{children:[(0,Y.jsxs)(o.A,{variant:"h4",sx:{mb:3,fontWeight:700,display:"flex",alignItems:"center",gap:1},children:[(0,Y.jsx)(p.A,{}),"Admin Dashboard"]}),s&&(0,Y.jsx)(x.A,{severity:"warning",sx:{mb:2},children:s}),(0,Y.jsxs)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Total Users",value:T.totalUsers,icon:(0,Y.jsx)(g.A,{}),color:"#1976d2",subtitle:"".concat(T.activeUsers," active")})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"System Revenue",value:"$".concat((T.pipelineValue/1e3).toFixed(0),"K"),icon:(0,Y.jsx)(y.A,{}),color:"#2e7d32",subtitle:"Pipeline value"})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Properties",value:T.totalProperties,icon:(0,Y.jsx)(v.A,{}),color:"#f57c00",subtitle:"Total listings"})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Active Deals",value:T.totalDeals,icon:(0,Y.jsx)(f.A,{}),color:"#7b1fa2",subtitle:"In pipeline"})})]}),(0,Y.jsxs)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Administrators",value:T.adminUsers,icon:(0,Y.jsx)(S.A,{}),color:"#d32f2f",subtitle:"Super users"})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Managers",value:T.managerUsers,icon:(0,Y.jsx)(p.A,{}),color:"#1976d2",subtitle:"Team leads"})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Agents",value:T.agentUsers,icon:(0,Y.jsx)(g.A,{}),color:"#388e3c",subtitle:"Sales team"})}),(0,Y.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,Y.jsx)(E,{title:"Recent Logins",value:T.recentLogins,icon:(0,Y.jsx)(b.A,{}),color:"#f57c00",subtitle:"Past 7 days"})})]}),(0,Y.jsxs)(A.A,{sx:{p:3},children:[(0,Y.jsxs)(m.A,{value:C,onChange:(e,t)=>I(t),sx:{mb:3},children:[(0,Y.jsx)(u.A,{label:"Users",icon:(0,Y.jsx)(g.A,{}),iconPosition:"start"}),(0,Y.jsx)(u.A,{label:"Teams",icon:(0,Y.jsx)(z.A,{}),iconPosition:"start"}),(0,Y.jsx)(u.A,{label:"Roles",icon:(0,Y.jsx)(S.A,{}),iconPosition:"start"})]}),(0,Y.jsx)(M,{value:C,index:0,children:(0,Y.jsx)(G,{})}),(0,Y.jsx)(M,{value:C,index:1,children:(0,Y.jsx)(te,{})}),(0,Y.jsx)(M,{value:C,index:2,children:(0,Y.jsx)(ae,{})})]})]})}}}]);
//# sourceMappingURL=5738.987ed240.chunk.js.map