"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[4986],{16597:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(65043);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{threshold:t=.1,rootMargin:a="0px",triggerOnce:i=!0,initialVisible:r=!1}=e,s=(0,n.useRef)(null),[o,l]=(0,n.useState)(r);return(0,n.useEffect)(()=>{const e=new IntersectionObserver(t=>{let[a]=t;a.isIntersecting?(l(!0),i&&s.current&&e.unobserve(s.current)):i||l(!1)},{threshold:t,rootMargin:a}),n=s.current;return n&&e.observe(n),()=>{n&&e.unobserve(n)}},[t,a,i]),[s,o]}},42223:(e,t,a)=>{a.d(t,{kx:()=>s,vG:()=>r,vn:()=>o,zb:()=>i});var n=a(94505);const i={getDeals:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deals:",t),t}},getDeal:async e=>{try{return(await n.Ay.get("/deals/".concat(e))).data}catch(t){throw console.error("Error fetching deal:",t),t}},createDeal:async e=>{try{return(await n.Ay.post("/deals",e)).data}catch(t){throw console.error("Error creating deal:",t),t}},updateDeal:async(e,t)=>{try{return(await n.Ay.put("/deals/".concat(e),t)).data}catch(a){throw console.error("Error updating deal:",a),a}},deleteDeal:async e=>{try{return(await n.Ay.delete("/deals/".concat(e))).data}catch(t){throw console.error("Error deleting deal:",t),t}},updateDealStage:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{return(await n.Ay.put("/deals/".concat(e,"/stage"),{stage:t,notes:a})).data}catch(i){throw console.error("Error updating deal stage:",i),i}},addActivity:async(e,t)=>{try{return(await n.Ay.post("/deals/".concat(e,"/activities"),t)).data}catch(a){throw console.error("Error adding deal activity:",a),a}},getDealActivities:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=new URLSearchParams(t).toString(),i="/deals/".concat(e,"/activities").concat(a?"?".concat(a):"");return(await n.Ay.get(i)).data}catch(a){throw console.error("Error fetching deal activities:",a),a}},updateProbability:async(e,t)=>{try{return(await n.Ay.put("/deals/".concat(e,"/probability"),{probability:t})).data}catch(a){throw console.error("Error updating deal probability:",a),a}},getPipelineStats:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/pipeline/stats".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching pipeline stats:",t),t}},getDealsByStage:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/pipeline".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deals by stage:",t),t}},bulkUpdateDeals:async(e,t)=>{try{return(await n.Ay.post("/deals/bulk-update",{dealIds:e,updates:t})).data}catch(a){throw console.error("Error bulk updating deals:",a),a}},duplicateDeal:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return(await n.Ay.post("/deals/".concat(e,"/duplicate"),t)).data}catch(a){throw console.error("Error duplicating deal:",a),a}},exportDeals:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/export".concat(t?"?".concat(t):"");return(await n.Ay.get(a,{responseType:"blob"})).data}catch(t){throw console.error("Error exporting deals:",t),t}},getDealForecast:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/forecast".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deal forecast:",t),t}},getConversionMetrics:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/metrics/conversion".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching conversion metrics:",t),t}}},r=[{id:"prospecting",name:"Prospecting",description:"Initial contact and qualification",probability:10,color:"#e3f2fd"},{id:"qualification",name:"Qualification",description:"Assessing fit and requirements",probability:25,color:"#f3e5f5"},{id:"proposal",name:"Proposal",description:"Preparing and presenting offer",probability:50,color:"#fff3e0"},{id:"negotiation",name:"Negotiation",description:"Terms and price negotiation",probability:75,color:"#e8f5e8"},{id:"contract",name:"Contract",description:"Finalizing legal agreements",probability:90,color:"#e1f5fe"},{id:"closed_won",name:"Closed Won",description:"Deal successfully completed",probability:100,color:"#e8f5e8"},{id:"closed_lost",name:"Closed Lost",description:"Deal not successful",probability:0,color:"#ffebee"}],s=[{id:"low",name:"Low",color:"#9e9e9e"},{id:"medium",name:"Medium",color:"#ff9800"},{id:"high",name:"High",color:"#f44336"},{id:"urgent",name:"Urgent",color:"#d32f2f"}],o=[{id:"sale",name:"Sale"},{id:"lease",name:"Lease"},{id:"purchase",name:"Purchase"},{id:"sublease",name:"Sublease"},{id:"management",name:"Property Management"},{id:"development",name:"Development"},{id:"investment",name:"Investment"}]},48309:(e,t,a)=>{a.d(t,{A:()=>l});a(65043);var n=a(96446),i=a(85865),r=a(11906),s=a(26240),o=a(70579);const l=e=>{let{icon:t,title:a,message:l,actionLabel:c,onAction:d}=e;const x=(0,s.A)();return(0,o.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:{xs:"300px",sm:"400px",md:"500px"},padding:x.spacing(4),textAlign:"center",animation:"fadeIn 0.6s ease-out","@keyframes fadeIn":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}}},children:[(0,o.jsx)(n.A,{sx:{position:"relative",mb:x.spacing(4),animation:"scaleIn 0.5s ease-out",animationDelay:"0.2s",animationFillMode:"both","@keyframes scaleIn":{from:{transform:"scale(0.8)",opacity:0},to:{transform:"scale(1)",opacity:1}}},children:(0,o.jsx)(n.A,{sx:{width:{xs:80,sm:100,md:120},height:{xs:80,sm:100,md:120},borderRadius:"50%",background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative","&::before":{content:'""',position:"absolute",top:-2,left:-2,right:-2,bottom:-2,background:x.palette.gradient.primary,borderRadius:"50%",zIndex:-1,opacity:.2}},children:t&&(0,o.jsx)(n.A,{sx:{background:x.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)(t,{sx:{fontSize:{xs:40,sm:50,md:60},opacity:1,filter:"drop-shadow(0 2px 4px rgba(102, 126, 234, 0.2))"}})})})}),(0,o.jsxs)(n.A,{sx:{maxWidth:{xs:"100%",sm:500,md:600},mb:x.spacing(2),animation:"fadeInUp 0.6s ease-out",animationDelay:"0.3s",animationFillMode:"both","@keyframes fadeInUp":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}}},children:[(0,o.jsx)(i.A,{variant:"h4",sx:{fontWeight:700,mb:x.spacing(2),background:x.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",fontSize:{xs:"1.5rem",sm:"1.875rem",md:"2.125rem"},letterSpacing:"-0.01em"},children:a}),(0,o.jsx)(i.A,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"},lineHeight:1.6,px:{xs:2,sm:0}},children:l})]}),c&&d&&(0,o.jsx)(n.A,{sx:{animation:"fadeInUp 0.6s ease-out",animationDelay:"0.4s",animationFillMode:"both"},children:(0,o.jsx)(r.A,{variant:"contained",onClick:d,sx:{background:x.palette.gradient.primary,color:"white",padding:{xs:"10px 24px",sm:"12px 32px"},fontSize:{xs:"0.875rem",sm:"1rem"},fontWeight:600,borderRadius:3,textTransform:"none",boxShadow:"0 8px 24px rgba(102, 126, 234, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{background:"linear-gradient(135deg, #5568d3 0%, #653a8b 100%)",boxShadow:"0 12px 32px rgba(102, 126, 234, 0.4)",transform:"translateY(-2px)"},"&:active":{transform:"translateY(0)",boxShadow:"0 6px 16px rgba(102, 126, 234, 0.3)"}},children:c})})]})}},74986:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var n=a(89379),i=a(65043),r=a(73216),s=a(26240),o=a(96446),l=a(67254),c=a(85865),d=a(11906),x=a(68903),p=a(63336),h=a(55263),g=a(77739),u=a(17392),m=a(51962),b=a(12110),y=a(26494),A=a(78185),f=a(43845),j=a(81045),v=a(72437),w=a(32143),S=a(2050),k=a(48734),C=a(39336),D=a(83462),z=a(26600),I=a(35316),P=a(53193),W=a(18356),R=a(72221),E=a(67784),F=a(29347),U=a(99070),L=a(73158),N=a(70141),B=a(2780),T=a(15337),M=a(67957),Y=a(33438),_=a(83560),V=a(58558),q=a(59893),H=a(47805),G=a(41209),O=a(31973),J=a(42796),Q=a(10529),X=a(3632),Z=a(22717),K=a(42223),$=a(16597),ee=a(48309),te=a(70579);const ae=()=>{const e=(0,r.Zp)(),t=(0,s.A)(),[a,ae]=(0,$.A)({threshold:.1}),[ne,ie]=(0,i.useState)({}),[re,se]=(0,i.useState)(!0),[oe,le]=(0,i.useState)(null),[ce,de]=(0,i.useState)({open:!1,message:"",severity:"success"}),[xe,pe]=(0,i.useState)({element:null,deal:null}),[he,ge]=(0,i.useState)({open:!1,deal:null,newStage:"",notes:""}),[ue,me]=(0,i.useState)({open:!1,deal:null,probability:50}),[be,ye]=(0,i.useState)({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0}),[Ae,fe]=(0,i.useState)(new Set),[je,ve]=(0,i.useState)(!1),[we,Se]=(0,i.useState)({type:"",value:""}),ke=(0,i.useCallback)(async()=>{try{se(!0),le(null);const[e,t]=await Promise.all([K.zb.getDealsByStage(),K.zb.getPipelineStats()]);e&&e.dealsByStage?ie(e.dealsByStage):ie({}),t&&t.stats?ye(t.stats):ye({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0})}catch(e){console.error("Failed to load pipeline data:",e),ie({}),ye({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0}),de({open:!0,message:"Failed to load pipeline data. Please try again.",severity:"error"})}finally{se(!1)}},[]);(0,i.useEffect)(()=>{ke()},[ke]);const Ce=(0,i.useCallback)(async e=>{var t;const{destination:a,source:i,draggableId:r}=e;if(!a)return;if(a.droppableId===i.droppableId&&a.index===i.index)return;const s=i.droppableId,o=a.droppableId,l=r;if(!(null===(t=ne[s])||void 0===t?void 0:t.find(e=>String(e.id)===l)))return;const c={};Object.keys(ne).forEach(e=>{c[e]=[...ne[e]||[]]});const[d]=c[s].splice(i.index,1),x=K.vG.find(e=>e.id===o),p=(0,n.A)((0,n.A)({},d),{},{stage:o,probability:x?x.probability:d.probability});c[o]=c[o]||[],c[o].splice(a.index,0,p);const h=ne;ie(c);try{await K.zb.updateDealStage(d.id,o,"Moved from ".concat(s," to ").concat(o)),de({open:!0,message:"Deal moved to ".concat((null===x||void 0===x?void 0:x.name)||o),severity:"success"})}catch(g){ie(h),de({open:!0,message:"Failed to update deal stage",severity:"error"})}},[ne]),De=(0,i.useCallback)((e,t)=>{pe({element:e.currentTarget,deal:t})},[]),ze=(0,i.useCallback)(()=>{pe({element:null,deal:null})},[]),Ie=(0,i.useCallback)(t=>{e("/deals/".concat(t.id))},[e]),Pe=(0,i.useCallback)(t=>{e("/deals/".concat(t.id,"/edit"))},[e]),We=(0,i.useCallback)(e=>{ge({open:!0,deal:e,newStage:e.stage,notes:""}),pe({element:null,deal:null})},[]),Re=(0,i.useCallback)(e=>{me({open:!0,deal:e,probability:e.probability}),pe({element:null,deal:null})},[]),Ee=(0,i.useCallback)((e,t)=>{t.stopPropagation(),fe(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),Fe=(0,i.useCallback)(e=>{const t=(ne[e]||[]).map(e=>e.id);fe(e=>{const a=new Set(e);return t.every(e=>a.has(e))?t.forEach(e=>a.delete(e)):t.forEach(e=>a.add(e)),a})},[ne]),Ue=(0,i.useCallback)(e=>{Se({type:"stage",value:e}),ve(!0)},[]),Le=(0,i.useCallback)(()=>{Se({type:"delete",value:null}),ve(!0)},[]),Ne=(0,i.useCallback)(async()=>{const e=Array.from(Ae);if(0!==e.length)try{let t={};"stage"===we.type?t.stage=we.value:"delete"===we.type&&(t.status="archived");const a=await K.zb.bulkUpdateDeals(e,t);a.success?(await ke(),de({open:!0,message:"Successfully updated ".concat(a.updated," deal(s)"),severity:"success"}),fe(new Set),ve(!1)):de({open:!0,message:a.message||"Bulk update failed",severity:"error"})}catch(t){console.error("Bulk update error:",t),de({open:!0,message:"Failed to update deals. Please try again.",severity:"error"})}},[Ae,we,ke]),Be=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Te=(e,t)=>({prospecting:t.palette.gradient.info,qualification:t.palette.gradient.primary,proposal:t.palette.gradient.warning,negotiation:t.palette.gradient.secondary,contract:t.palette.gradient.success,closed_won:t.palette.gradient.success,closed_lost:t.palette.gradient.secondary}[e]||t.palette.gradient.primary),Me=(e,t)=>({high:t.palette.gradient.warning,medium:t.palette.gradient.info,low:t.palette.gradient.secondary}[e]||t.palette.gradient.secondary),Ye=!re&&Object.keys(ne).every(e=>{const t=ne[e];return!t||0===t.length});return oe?(0,te.jsxs)(o.A,{children:[(0,te.jsxs)(l.A,{severity:"error",sx:{mb:2},children:[(0,te.jsx)(c.A,{variant:"h6",children:"Failed to load pipeline"}),(0,te.jsx)(c.A,{children:oe})]}),(0,te.jsx)(d.A,{variant:"contained",onClick:()=>window.location.reload(),sx:{mt:2},children:"Retry"})]}):(0,te.jsxs)(o.A,{children:[(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,animation:"fadeInScale 0.6s ease-out"},children:[(0,te.jsx)(c.A,{variant:"h4",sx:{fontWeight:700},children:"Sales Pipeline"}),(0,te.jsxs)(o.A,{sx:{display:"flex",gap:1},children:[(0,te.jsx)(d.A,{variant:"outlined",startIcon:(0,te.jsx)(Q.A,{}),onClick:()=>e("/deals"),children:"List View"}),(0,te.jsx)(d.A,{variant:"outlined",onClick:ke,disabled:re,startIcon:(0,te.jsx)(H.A,{className:"icon-spin-hover"}),children:"Refresh"}),(0,te.jsx)(d.A,{variant:"contained",startIcon:(0,te.jsx)(N.A,{}),onClick:()=>e("/deals/new"),children:"Add Deal"})]})]}),(0,te.jsx)(o.A,{ref:a,sx:{opacity:ae?1:0,transform:ae?"translateY(0)":"translateY(30px)",transition:"all 0.6s ease-out"},children:(0,te.jsxs)(x.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,te.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,te.jsxs)(p.A,{sx:{p:2,textAlign:"center"},children:[(0,te.jsx)(c.A,{variant:"h4",sx:{fontWeight:700,color:"primary.main"},children:Be(be.totalValue)}),(0,te.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Total Pipeline Value"})]})}),(0,te.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,te.jsxs)(p.A,{sx:{p:2,textAlign:"center"},children:[(0,te.jsx)(c.A,{variant:"h4",sx:{fontWeight:700,color:"info.main"},children:be.totalDeals}),(0,te.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Active Deals"})]})}),(0,te.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,te.jsxs)(p.A,{sx:{p:2,textAlign:"center"},children:[(0,te.jsx)(c.A,{variant:"h4",sx:{fontWeight:700,color:"success.main"},children:Be(be.averageDealSize)}),(0,te.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Average Deal Size"})]})}),(0,te.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,te.jsxs)(p.A,{sx:{p:2,textAlign:"center"},children:[(0,te.jsxs)(c.A,{variant:"h4",sx:{fontWeight:700,color:"warning.main"},children:[be.winRate.toFixed(1),"%"]}),(0,te.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Win Rate"})]})})]})}),Ye&&(0,te.jsx)(ee.A,{icon:T.A,title:"No deals in pipeline",message:"Get started by creating your first deal to track your opportunities",actionLabel:"Add Deal",onAction:()=>e("/deals/new")}),!Ye&&(0,te.jsxs)(te.Fragment,{children:[Ae.size>0&&(0,te.jsx)(p.A,{elevation:10,sx:{position:"sticky",top:16,zIndex:1e3,mb:3,background:"linear-gradient(135deg, ".concat(t.palette.gradient.primary.main,", ").concat(t.palette.gradient.primary.light,")"),borderRadius:"12px",overflow:"hidden",animation:"fadeInUp 0.3s ease-out"},children:(0,te.jsxs)(h.A,{children:[(0,te.jsxs)(c.A,{variant:"h6",sx:{flex:1,color:"white"},children:[Ae.size," deal",1!==Ae.size?"s":""," selected"]}),(0,te.jsx)(g.A,{title:"Change Stage",children:(0,te.jsx)(u.A,{onClick:()=>Ue("qualification"),sx:{color:"white",mr:1},children:(0,te.jsx)(O.A,{})})}),(0,te.jsx)(g.A,{title:"Archive Selected",children:(0,te.jsx)(u.A,{onClick:Le,sx:{color:"white"},children:(0,te.jsx)(B.A,{})})}),(0,te.jsx)(g.A,{title:"Clear Selection",children:(0,te.jsx)(u.A,{onClick:()=>fe(new Set),sx:{color:"white",ml:2},children:(0,te.jsx)(Y.A,{})})})]})}),(0,te.jsx)(Z.JY,{onDragEnd:Ce,children:(0,te.jsx)(o.A,{sx:{display:"flex",gap:2,overflowX:"auto",pb:2},children:K.vG.filter(e=>"closed_lost"!==e.id).map(e=>{const a=ne[e.id]||[],i=a.reduce((e,t)=>e+t.value,0);return(0,te.jsxs)(p.A,{sx:{minWidth:280,maxWidth:280,borderRadius:3,boxShadow:2,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[(0,te.jsxs)(o.A,{sx:{p:1.25,background:Te(e.id,t),color:"white"},children:[(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[(0,te.jsx)(c.A,{variant:"subtitle1",sx:{fontWeight:600,color:"white",fontSize:"0.938rem"},children:e.name}),!re&&a.length>0&&(0,te.jsx)(g.A,{title:"Select all deals in this stage",children:(0,te.jsx)(m.A,{checked:a.length>0&&a.every(e=>Ae.has(e.id)),indeterminate:a.some(e=>Ae.has(e.id))&&!a.every(e=>Ae.has(e.id)),onChange:()=>Fe(e.id),sx:{color:"rgba(255, 255, 255, 0.7)","&.Mui-checked":{color:"white"},"&.MuiCheckbox-indeterminate":{color:"white"}}})})]}),(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,te.jsx)(c.A,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:"0.813rem"},children:re?"-":"".concat(a.length," deal").concat(1!==a.length?"s":"")}),(0,te.jsx)(c.A,{variant:"caption",sx:{fontWeight:600,color:"white",fontSize:"0.813rem"},children:re?"-":Be(i)})]})]}),(0,te.jsx)(Z.gL,{droppableId:e.id,children:(i,r)=>(0,te.jsxs)(o.A,(0,n.A)((0,n.A)({ref:i.innerRef},i.droppableProps),{},{sx:{minHeight:200,maxHeight:600,overflowY:"auto",p:.75,backgroundColor:r.isDraggingOver?"action.hover":"transparent"},children:[re?[...Array(2)].map((e,t)=>(0,te.jsx)(b.A,{sx:{mb:.75,borderRadius:2,boxShadow:1},children:(0,te.jsxs)(y.A,{sx:{p:1.25,"&:last-child":{pb:1.25}},children:[(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,te.jsx)(A.A,{variant:"rounded",width:60,height:20,animation:"wave",sx:{borderRadius:2}}),(0,te.jsx)(A.A,{variant:"circular",width:24,height:24,animation:"wave"})]}),(0,te.jsx)(A.A,{variant:"text",width:"80%",height:24,animation:"wave",sx:{mb:1}}),(0,te.jsx)(A.A,{variant:"text",width:"50%",height:32,animation:"wave",sx:{mb:1}}),(0,te.jsxs)(o.A,{sx:{mb:1},children:[(0,te.jsx)(A.A,{variant:"text",width:"100%",height:16,animation:"wave",sx:{mb:.5}}),(0,te.jsx)(A.A,{variant:"rounded",width:"100%",height:6,animation:"wave",sx:{borderRadius:3}})]}),(0,te.jsx)(A.A,{variant:"text",width:"70%",height:16,animation:"wave",sx:{mb:.5}}),(0,te.jsx)(A.A,{variant:"text",width:"60%",height:16,animation:"wave"})]})},"skeleton-".concat(t))):0===a.length?(0,te.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4,px:2},children:[(0,te.jsx)(c.A,{variant:"body2",color:"text.secondary",align:"center",children:"No deals in this stage"}),(0,te.jsx)(c.A,{variant:"caption",color:"text.secondary",align:"center",sx:{mt:.5},children:"Drag deals here to update their stage"})]}):a.map((a,i)=>{const r=(s=a.priority,K.kx.find(e=>e.id===s)||K.kx[0]);var s;return(0,te.jsx)(Z.sx,{draggableId:String(a.id),index:i,children:(i,s)=>{var l,d,x,p,h,A,v,w;return(0,te.jsx)(b.A,(0,n.A)((0,n.A)((0,n.A)({ref:i.innerRef},i.draggableProps),i.dragHandleProps),{},{sx:{mb:.75,cursor:"grab",borderRadius:2,boxShadow:s.isDragging?3:1,transform:s.isDragging?"rotate(5deg)":"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative","&:hover":{boxShadow:3,transform:"translateY(-2px)","& .quick-actions":{opacity:1,visibility:"visible"}}},children:(0,te.jsxs)(y.A,{sx:{p:1.25,"&:last-child":{pb:1.25}},children:[(0,te.jsx)(m.A,{checked:Ae.has(a.id),onChange:e=>Ee(a.id,e),onClick:e=>e.stopPropagation(),size:"small",sx:{position:"absolute",top:4,left:4,zIndex:10,padding:.5,color:"white","&.Mui-checked":{color:t.palette.gradient.secondary.main}}}),(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[(0,te.jsx)(f.A,{label:r.name,size:"small",sx:{background:Me(a.priority,t),color:"white",fontSize:"0.688rem",height:18,fontWeight:600,backdropFilter:"blur(10px)",border:"none"}}),(0,te.jsx)(u.A,{size:"small",onClick:e=>{e.stopPropagation(),De(e,a)},sx:{p:.5,transition:"all 0.2s","&:hover":{backgroundColor:"action.hover",transform:"scale(1.1)"}},children:(0,te.jsx)(V.A,{sx:{fontSize:16}})})]}),(0,te.jsx)(c.A,{variant:"caption",sx:{fontWeight:600,fontSize:"0.875rem",mb:.5,display:"block",cursor:"pointer",transition:"color 0.2s","&:hover":{background:t.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}},onClick:e=>{e.stopPropagation(),Ie(a)},children:a.name}),(0,te.jsx)(c.A,{variant:"subtitle1",sx:{background:t.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:700,fontSize:"1rem",mb:.5},children:Be(a.value)}),(0,te.jsxs)(o.A,{sx:{mb:.5},children:[(0,te.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.25},children:[(0,te.jsx)(c.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:"Probability"}),(0,te.jsxs)(c.A,{variant:"caption",sx:{fontWeight:600,fontSize:"0.688rem"},children:[a.probability,"%"]})]}),(0,te.jsx)(o.A,{sx:{height:4,borderRadius:2,background:"rgba(0, 0, 0, 0.1)",overflow:"hidden"},children:(0,te.jsx)(o.A,{sx:{height:"100%",width:"".concat(a.probability,"%"),background:t.palette.gradient.success,transition:"width 0.3s ease"}})})]}),(0,te.jsxs)(o.A,{className:"quick-actions",sx:{display:"flex",gap:.5,mt:.5,opacity:0,visibility:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,te.jsx)(g.A,{title:"View Deal",children:(0,te.jsx)(u.A,{size:"small",onClick:e=>{e.stopPropagation(),Ie(a)},sx:{flex:1,borderRadius:1.5,p:.5,background:t.palette.gradient.info,color:"white","&:hover":{background:t.palette.gradient.info,opacity:.9}},children:(0,te.jsx)(X.A,{sx:{fontSize:14}})})}),(0,te.jsx)(g.A,{title:"Edit Deal",children:(0,te.jsx)(u.A,{size:"small",onClick:e=>{e.stopPropagation(),Pe(a)},sx:{flex:1,borderRadius:1.5,p:.5,background:t.palette.gradient.warning,color:"white","&:hover":{background:t.palette.gradient.warning,opacity:.9}},children:(0,te.jsx)(_.A,{sx:{fontSize:14}})})})]}),(0,te.jsx)(o.A,{sx:{mt:.5,mb:.5},children:(0,te.jsx)(f.A,{label:e.name,size:"small",sx:{background:Te(e.id,t),color:"white",fontSize:"0.688rem",height:18,fontWeight:600,backdropFilter:"blur(10px)"}})}),(0,te.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:.5},children:[(0,te.jsx)(q.A,{sx:{fontSize:12,mr:.5,color:"text.secondary"}}),(0,te.jsx)(c.A,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.688rem"},children:"company"===(null===(l=a.contact)||void 0===l?void 0:l.type)?null===(d=a.contact)||void 0===d?void 0:d.companyName:"".concat(null===(x=a.contact)||void 0===x?void 0:x.firstName," ").concat(null===(p=a.contact)||void 0===p?void 0:p.lastName)})]}),(0,te.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:.5},children:[(0,te.jsx)(G.A,{sx:{fontSize:12,mr:.5,color:"text.secondary"}}),(0,te.jsx)(c.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:new Date(a.expectedCloseDate).toLocaleDateString()})]}),(0,te.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,te.jsx)(j.A,{sx:{width:16,height:16,mr:.5,fontSize:"0.625rem"},children:null===(h=a.assignedTo)||void 0===h||null===(A=h.firstName)||void 0===A?void 0:A[0]}),(0,te.jsxs)(c.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:[null===(v=a.assignedTo)||void 0===v?void 0:v.firstName," ",null===(w=a.assignedTo)||void 0===w?void 0:w.lastName]})]})]})}))}},a.id)}),i.placeholder]}))})]},e.id)})})})]}),(0,te.jsxs)(v.A,{anchorEl:xe.element,open:Boolean(xe.element),onClose:ze,children:[(0,te.jsxs)(w.A,{onClick:()=>{Ie(xe.deal),ze()},children:[(0,te.jsx)(S.A,{children:(0,te.jsx)(X.A,{fontSize:"small"})}),(0,te.jsx)(k.A,{children:"View Details"})]}),(0,te.jsxs)(w.A,{onClick:()=>{Pe(xe.deal),ze()},children:[(0,te.jsx)(S.A,{children:(0,te.jsx)(_.A,{fontSize:"small"})}),(0,te.jsx)(k.A,{children:"Edit Deal"})]}),(0,te.jsx)(C.A,{}),(0,te.jsxs)(w.A,{onClick:()=>We(xe.deal),children:[(0,te.jsx)(S.A,{children:(0,te.jsx)(J.A,{fontSize:"small"})}),(0,te.jsx)(k.A,{children:"Update Stage"})]}),(0,te.jsxs)(w.A,{onClick:()=>Re(xe.deal),children:[(0,te.jsx)(S.A,{children:(0,te.jsx)(M.A,{fontSize:"small"})}),(0,te.jsx)(k.A,{children:"Update Probability"})]})]}),(0,te.jsxs)(D.A,{open:he.open,onClose:()=>ge({open:!1,deal:null,newStage:"",notes:""}),children:[(0,te.jsx)(z.A,{children:"Update Deal Stage"}),(0,te.jsx)(I.A,{sx:{minWidth:400},children:(0,te.jsxs)(o.A,{sx:{pt:1},children:[(0,te.jsxs)(P.A,{fullWidth:!0,sx:{mb:2},children:[(0,te.jsx)(W.A,{children:"New Stage"}),(0,te.jsx)(R.A,{value:he.newStage,label:"New Stage",onChange:e=>ge(t=>(0,n.A)((0,n.A)({},t),{},{newStage:e.target.value})),children:K.vG.filter(e=>"closed_lost"!==e.id).map(e=>(0,te.jsxs)(w.A,{value:e.id,children:[e.name," (",e.probability,"%)"]},e.id))})]}),(0,te.jsx)(E.A,{fullWidth:!0,label:"Notes (optional)",multiline:!0,rows:3,value:he.notes,onChange:e=>ge(t=>(0,n.A)((0,n.A)({},t),{},{notes:e.target.value})),helperText:"Add any notes about this stage change"})]})}),(0,te.jsxs)(F.A,{children:[(0,te.jsx)(d.A,{onClick:()=>ge({open:!1,deal:null,newStage:"",notes:""}),children:"Cancel"}),(0,te.jsx)(d.A,{onClick:async()=>{try{await K.zb.updateDealStage(he.deal.id,he.newStage,he.notes);const t=(0,n.A)({},ne),a=he.deal.stage,i=he.newStage;if(a!==i){var e;t[a]=t[a].filter(e=>e.id!==he.deal.id);const r=(0,n.A)((0,n.A)({},he.deal),{},{stage:i,probability:(null===(e=K.vG.find(e=>e.id===i))||void 0===e?void 0:e.probability)||he.deal.probability});t[i]=t[i]||[],t[i].push(r),ie(t)}de({open:!0,message:"Deal stage updated successfully",severity:"success"})}catch(t){de({open:!0,message:"Failed to update deal stage",severity:"error"})}ge({open:!1,deal:null,newStage:"",notes:""})},variant:"contained",children:"Update Stage"})]})]}),(0,te.jsxs)(D.A,{open:ue.open,onClose:()=>me({open:!1,deal:null,probability:50}),children:[(0,te.jsx)(z.A,{children:"Update Deal Probability"}),(0,te.jsx)(I.A,{sx:{minWidth:400},children:(0,te.jsxs)(o.A,{sx:{pt:2},children:[(0,te.jsxs)(c.A,{gutterBottom:!0,children:["Probability: ",ue.probability,"%"]}),(0,te.jsx)(U.Ay,{value:ue.probability,onChange:(e,t)=>me(e=>(0,n.A)((0,n.A)({},e),{},{probability:t})),valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:100,sx:{mb:2}}),(0,te.jsx)(c.A,{variant:"caption",color:"text.secondary",children:"Adjust the likelihood of this deal closing successfully"})]})}),(0,te.jsxs)(F.A,{children:[(0,te.jsx)(d.A,{onClick:()=>me({open:!1,deal:null,probability:50}),children:"Cancel"}),(0,te.jsx)(d.A,{onClick:async()=>{try{await K.zb.updateProbability(ue.deal.id,ue.probability);const e=(0,n.A)({},ne),t=ue.deal.stage,a=e[t].findIndex(e=>e.id===ue.deal.id);-1!==a&&(e[t][a].probability=ue.probability,ie(e)),de({open:!0,message:"Deal probability updated successfully",severity:"success"})}catch(e){de({open:!0,message:"Failed to update deal probability",severity:"error"})}me({open:!1,deal:null,probability:50})},variant:"contained",children:"Update Probability"})]})]}),(0,te.jsxs)(D.A,{open:je,onClose:()=>ve(!1),children:[(0,te.jsx)(z.A,{children:"Confirm Bulk Action"}),(0,te.jsx)(I.A,{children:(0,te.jsxs)(c.A,{children:["stage"===we.type&&"Change stage to ".concat(we.value," for ").concat(Ae.size," deal(s)?"),"delete"===we.type&&"Archive ".concat(Ae.size," deal(s)?")]})}),(0,te.jsxs)(F.A,{children:[(0,te.jsx)(d.A,{onClick:()=>ve(!1),children:"Cancel"}),(0,te.jsx)(d.A,{onClick:Ne,variant:"contained",color:"primary",children:"Confirm"})]})]}),(0,te.jsx)(L.A,{open:ce.open,autoHideDuration:6e3,onClose:()=>de((0,n.A)((0,n.A)({},ce),{},{open:!1})),children:(0,te.jsx)(l.A,{onClose:()=>de((0,n.A)((0,n.A)({},ce),{},{open:!1})),severity:ce.severity,sx:{width:"100%"},children:ce.message})})]})}}}]);
//# sourceMappingURL=4986.6e1c469b.chunk.js.map