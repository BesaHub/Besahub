"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[5836],{7183:(e,t,s)=>{s.d(t,{H4:()=>p,M:()=>o,Me:()=>x,jw:()=>n,mF:()=>d,xQ:()=>A});var r=s(89379),a=s(5766),i=s.n(a);const n={name:["name","property_name","title","property_title"],address:["address","street_address","street","location"],city:["city"],state:["state","region"],zipCode:["zip_code","zipcode","zip","postal_code"],propertyType:["property_type","type","category"],status:["status"],listingType:["listing_type","listing","sale_type"],listPrice:["list_price","price","asking_price","sale_price"],leaseRate:["lease_rate","rent","rental_rate","lease_price"],totalSquareFootage:["total_square_footage","sqft","square_feet","total_sqft","size"],buildingClass:["building_class","class","grade"],yearBuilt:["year_built","built_year","construction_year"],description:["description","notes","details"],zoning:["zoning"],parkingSpaces:["parking_spaces","parking","parking_spots"],marketingStatus:["marketing_status","listing_status"],pricePerSquareFoot:["price_per_square_foot","price_per_sqft","psf"]},o={firstName:["first_name","firstname","fname","given_name"],lastName:["last_name","lastname","lname","surname","family_name"],email:["email","email_address","e_mail"],phone:["phone","phone_number","mobile","telephone","cell"],company:["company","organization","business","employer"],title:["title","job_title","position","role"],type:["type","contact_type","category"],source:["source","lead_source","origin"],address:["address","street_address","street"],city:["city"],state:["state","region"],zipCode:["zip_code","zipcode","zip","postal_code"],country:["country"],website:["website","web","url","homepage"],notes:["notes","description","comments","remarks"]},l={propertyType:["office","retail","industrial","warehouse","multifamily","hotel","mixed_use","land","other"],status:["available","under_contract","sold","leased","off_market"],listingType:["sale","lease"],buildingClass:["A","B","C"],marketingStatus:["draft","published","archived"]},c={type:["lead","prospect","client","investor","vendor","broker"],source:["website","referral","cold_call","email","social_media","event","advertisement","other"]},d=e=>new Promise((t,s)=>{i().parse(e,{header:!0,skipEmptyLines:!0,transformHeader:e=>e.trim().toLowerCase().replace(/\s+/g,"_"),transform:e=>e.trim(),complete:e=>{e.errors.length>0?s(new Error("CSV parsing errors: ".concat(e.errors.map(e=>e.message).join(", ")))):t({data:e.data,headers:e.meta.fields,totalRows:e.data.length})},error:e=>{s(e)}})}),p=(e,t)=>{const s={},r=[];return e.forEach(e=>{let a=!1;for(const[r,i]of Object.entries(t))if(i.includes(e)){s[e]=r,a=!0;break}a||r.push(e)}),{mapping:s,unmappedHeaders:r}},u=(e,t,s)=>{const r={},a=[],i=[];for(const[n,o]of Object.entries(e))if(t[n]&&o){r[t[n]]=o}return"property"===s?h(r,a,i):"contact"===s&&m(r,a,i),{data:r,errors:a,warnings:i,isValid:0===a.length}},h=(e,t,s)=>{e.name||e.address||t.push("Property must have either a name or address"),e.propertyType&&!l.propertyType.includes(e.propertyType)&&(s.push("Invalid property type: ".concat(e.propertyType,". Will default to 'other'")),e.propertyType="other"),e.status&&!l.status.includes(e.status)&&(s.push("Invalid status: ".concat(e.status,". Will default to 'available'")),e.status="available"),e.listingType&&!l.listingType.includes(e.listingType)&&(s.push("Invalid listing type: ".concat(e.listingType,". Will default to 'sale'")),e.listingType="sale"),e.buildingClass&&!l.buildingClass.includes(e.buildingClass)&&(s.push("Invalid building class: ".concat(e.buildingClass,". Will be cleared")),delete e.buildingClass),e.marketingStatus&&!l.marketingStatus.includes(e.marketingStatus)&&(s.push("Invalid marketing status: ".concat(e.marketingStatus,". Will default to 'draft'")),e.marketingStatus="draft");["listPrice","leaseRate","totalSquareFootage","yearBuilt","parkingSpaces","pricePerSquareFoot"].forEach(t=>{if(e[t]){const r=parseFloat(e[t].replace(/[$,]/g,""));isNaN(r)?(s.push("Invalid numeric value for ".concat(t,": ").concat(e[t],". Will be cleared")),delete e[t]):e[t]="yearBuilt"===t||"parkingSpaces"===t||"totalSquareFootage"===t?parseInt(r):r}}),e.yearBuilt&&(e.yearBuilt<1800||e.yearBuilt>(new Date).getFullYear()+5)&&s.push("Unusual year built: ".concat(e.yearBuilt)),e.propertyType||(e.propertyType="other"),e.status||(e.status="available"),e.listingType||(e.listingType="sale"),e.marketingStatus||(e.marketingStatus="draft")},m=(e,t,s)=>{e.firstName||e.lastName||e.email||t.push("Contact must have at least a first name, last name, or email"),e.email&&!/\S+@\S+\.\S+/.test(e.email)&&t.push("Invalid email format: ".concat(e.email)),e.type&&!c.type.includes(e.type)&&(s.push("Invalid contact type: ".concat(e.type,". Will default to 'lead'")),e.type="lead"),e.source&&!c.source.includes(e.source)&&(s.push("Invalid source: ".concat(e.source,". Will default to 'other'")),e.source="other"),e.phone&&(e.phone=e.phone.replace(/\D/g,""),e.phone.length<10&&s.push("Phone number seems too short: ".concat(e.phone))),e.website&&!e.website.startsWith("http")&&(e.website="https://"+e.website,s.push("Added https:// to website URL: ".concat(e.website))),e.type||(e.type="lead"),e.source||(e.source="other"),e.country||(e.country="US")},x=(e,t,s)=>{const a=[],i=[],n=[];return e.forEach((e,o)=>{const l=u(e,t,s);l.isValid?a.push((0,r.A)((0,r.A)({},l.data),{},{_originalRow:o+1,_warnings:l.warnings})):i.push((0,r.A)((0,r.A)({},e),{},{_originalRow:o+1,_errors:l.errors,_warnings:l.warnings})),n.push(...l.warnings)}),{validRows:a,invalidRows:i,totalRows:e.length,validCount:a.length,invalidCount:i.length,warnings:n}},y=e=>{let t,s;"property"===e?(t=["name","address","city","state","zip_code","property_type","status","listing_type","list_price","lease_rate","total_square_footage","building_class","year_built","description","zoning","parking_spaces","marketing_status","price_per_square_foot"],s=["Downtown Office Building","123 Main St","New York","NY","10001","office","available","sale","2500000","","15000","A","2020","Modern office space with city views","Commercial","50","published","167"]):(t=["first_name","last_name","email","phone","company","title","type","source","address","city","state","zip_code","country","website","notes"],s=["John","Smith","john.smith@email.com","555-123-4567","ABC Corp","CEO","client","referral","456 Business Ave","New York","NY","10002","US","https://abccorp.com","VIP client interested in office space"]);return[t.join(","),s.join(",")].join("\n")},A=(e,t)=>{const s=y(e),r=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){const s=URL.createObjectURL(r);a.setAttribute("href",s),a.setAttribute("download",t||"".concat(e,"_import_template.csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}}},25836:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var r=s(89379),a=s(65043),i=s(73216),n=s(12110),o=s(26494),l=s(96446),c=s(85865),d=s(39336),p=s(11906),u=s(79650),h=s(71806),m=s(84882),x=s(28076),y=s(10039),A=s(73460),g=s(43845),j=s(53193),v=s(18356),b=s(72221),f=s(32143),w=s(67254),C=s(30279),_=s(35721),S=s(24628),k=s(2050),R=s(48734),I=s(10611),B=s(63336),T=s(76839),z=s(25078),V=s(12299),D=s(73158),F=s(87332),N=s(98606),M=s(43374),P=s(47968),E=s(17548),U=s(73794),W=s(59893),q=s(44973),O=s(34642),L=s(8789),H=s(7183),Y=s(39705),Q=s(70579);const Z=()=>{const e=(0,i.Zp)(),[t,s]=(0,a.useState)(0),[Z,$]=(0,a.useState)(null),[J,G]=(0,a.useState)(null),[K,X]=(0,a.useState)({}),[ee,te]=(0,a.useState)([]),[se,re]=(0,a.useState)(null),[ae,ie]=(0,a.useState)(!1),[ne,oe]=(0,a.useState)(0),[le,ce]=(0,a.useState)(null),[de,pe]=(0,a.useState)({open:!1,message:"",severity:"info"}),[ue,he]=(0,a.useState)({valid:!1,invalid:!1,warnings:!1}),{getRootProps:me,getInputProps:xe,isDragActive:ye}=(0,L.VB)({onDrop:async e=>{const t=e[0];if(t)if("text/csv"===t.type||t.name.endsWith(".csv"))try{$(t);const e=await(0,H.mF)(t);G(e);const{mapping:r,unmappedHeaders:a}=(0,H.H4)(e.headers,H.M);X(r),te(a),s(1),pe({open:!0,message:"Successfully loaded ".concat(e.totalRows," rows from CSV"),severity:"success"})}catch(r){pe({open:!0,message:"Error parsing CSV: ".concat(r.message),severity:"error"})}else pe({open:!0,message:"Please upload a CSV file",severity:"error"})},accept:{"text/csv":[".csv"]},multiple:!1,maxSize:10485760}),Ae=()=>{const e=(0,H.Me)(J.data,K,"contact");re(e),s(2)},ge=()=>{s(3)},je=async()=>{ie(!0),oe(0);try{const{validRows:r}=se,a=r.length;let i=0,n=0;const o=[];for(let l=0;l<r.length;l++){try{await Y.TP.createContact(r[l]),i++}catch(s){var e,t;n++,o.push({row:r[l]._originalRow,error:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message})}oe((l+1)/a*100)}ce({total:a,success:i,errors:n,errorDetails:o}),pe({open:!0,message:"Import completed: ".concat(i," success, ").concat(n," errors"),severity:i>0?"success":"error"})}catch(s){pe({open:!0,message:"Import failed: ".concat(s.message),severity:"error"})}finally{ie(!1)}},ve=()=>{s(0),$(null),G(null),X({}),te([]),re(null),ce(null),oe(0)};return(0,Q.jsxs)(l.A,{children:[(0,Q.jsxs)(l.A,{sx:{mb:3},children:[(0,Q.jsx)(p.A,{startIcon:(0,Q.jsx)(F.A,{}),onClick:()=>{e("/contacts")},sx:{mb:2},children:"Back to Contacts"}),(0,Q.jsx)(c.A,{variant:"h4",sx:{fontWeight:700},children:"Import Contacts from CSV"}),(0,Q.jsx)(c.A,{variant:"body1",color:"text.secondary",children:"Bulk import contact data from a CSV file"})]}),(0,Q.jsx)(B.A,{sx:{p:3,mb:3},children:(0,Q.jsx)(T.A,{activeStep:t,children:["Upload CSV File","Map Columns","Review Data","Import Contacts"].map(e=>(0,Q.jsx)(z.A,{children:(0,Q.jsx)(V.A,{children:e})},e))})}),(0,Q.jsxs)(l.A,{children:[0===t&&(0,Q.jsx)(n.A,{children:(0,Q.jsx)(o.A,{children:(0,Q.jsxs)(l.A,{sx:{textAlign:"center",py:4},children:[(0,Q.jsx)(W.A,{sx:{fontSize:48,color:"primary.main",mb:2}}),(0,Q.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Upload Contact CSV File"}),(0,Q.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Upload a CSV file containing contact data to import into your system"}),(0,Q.jsxs)(l.A,(0,r.A)((0,r.A)({},me()),{},{sx:{border:"2px dashed",borderColor:ye?"primary.main":"grey.300",borderRadius:2,p:4,cursor:"pointer",mb:3,backgroundColor:ye?"primary.light":"background.paper","&:hover":{backgroundColor:"grey.50"}},children:[(0,Q.jsx)("input",(0,r.A)({},xe())),(0,Q.jsx)(M.A,{sx:{fontSize:48,color:"grey.500",mb:2}}),(0,Q.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:ye?"Drop CSV file here":"Upload CSV File"}),(0,Q.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:["Drag & drop your CSV file here, or click to browse",(0,Q.jsx)("br",{}),"Maximum file size: 10MB"]})]})),(0,Q.jsx)(d.A,{sx:{my:3},children:"OR"}),(0,Q.jsx)(p.A,{variant:"outlined",startIcon:(0,Q.jsx)(P.A,{}),onClick:()=>(0,H.xQ)("contact"),sx:{mr:2},children:"Download Template"}),(0,Q.jsx)(p.A,{variant:"text",startIcon:(0,Q.jsx)(U.A,{}),onClick:()=>pe({open:!0,message:"Template includes all supported contact fields with sample data",severity:"info"}),children:"Template Info"})]})})}),1===t&&(0,Q.jsx)(n.A,{children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Map CSV Columns to Contact Fields"}),(0,Q.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Map your CSV columns to the appropriate contact fields. Auto-mapped fields are shown below."}),(0,Q.jsx)(u.A,{children:(0,Q.jsxs)(h.A,{children:[(0,Q.jsx)(m.A,{children:(0,Q.jsxs)(x.A,{children:[(0,Q.jsx)(y.A,{children:"CSV Column"}),(0,Q.jsx)(y.A,{children:"Maps to Contact Field"}),(0,Q.jsx)(y.A,{children:"Sample Data"})]})}),(0,Q.jsx)(A.A,{children:null===J||void 0===J?void 0:J.headers.map(e=>{var t;return(0,Q.jsxs)(x.A,{children:[(0,Q.jsx)(y.A,{children:(0,Q.jsx)(g.A,{label:e,color:K[e]?"primary":"default",variant:"outlined"})}),(0,Q.jsx)(y.A,{children:(0,Q.jsxs)(j.A,{size:"small",sx:{minWidth:200},children:[(0,Q.jsx)(v.A,{children:"Select Field"}),(0,Q.jsxs)(b.A,{value:K[e]||"",label:"Select Field",onChange:t=>{return s=e,a=t.target.value,void X(e=>(0,r.A)((0,r.A)({},e),{},{[s]:a}));var s,a},children:[(0,Q.jsx)(f.A,{value:"",children:(0,Q.jsx)("em",{children:"Don't import"})}),Object.keys(H.M).map(e=>(0,Q.jsx)(f.A,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1")},e))]})]})}),(0,Q.jsx)(y.A,{children:(0,Q.jsx)(c.A,{variant:"body2",color:"text.secondary",children:(null===J||void 0===J||null===(t=J.data[0])||void 0===t?void 0:t[e])||"N/A"})})]},e)})})]})}),ee.length>0&&(0,Q.jsxs)(w.A,{severity:"warning",sx:{mt:2},children:["Unmapped columns: ",ee.join(", ")]}),(0,Q.jsx)(l.A,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:(0,Q.jsx)(p.A,{variant:"contained",onClick:Ae,disabled:0===Object.keys(K).length,children:"Review Data"})})]})}),2===t&&(()=>{var e;return(0,Q.jsxs)(l.A,{children:[(0,Q.jsx)(n.A,{sx:{mb:2},children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Data Review Summary"}),(0,Q.jsxs)(l.A,{sx:{display:"flex",gap:2,mb:2},children:[(0,Q.jsx)(g.A,{icon:(0,Q.jsx)(N.A,{}),label:"".concat((null===se||void 0===se?void 0:se.validCount)||0," Valid Rows"),color:"success",onClick:()=>he(e=>(0,r.A)((0,r.A)({},e),{},{valid:!e.valid})),clickable:!0}),(0,Q.jsx)(g.A,{icon:(0,Q.jsx)(E.A,{}),label:"".concat((null===se||void 0===se?void 0:se.invalidCount)||0," Invalid Rows"),color:"error",onClick:()=>he(e=>(0,r.A)((0,r.A)({},e),{},{invalid:!e.invalid})),clickable:!0}),(0,Q.jsx)(g.A,{icon:(0,Q.jsx)(O.A,{}),label:"".concat((null===se||void 0===se||null===(e=se.warnings)||void 0===e?void 0:e.length)||0," Warnings"),color:"warning",onClick:()=>he(e=>(0,r.A)((0,r.A)({},e),{},{warnings:!e.warnings})),clickable:!0})]}),(null===se||void 0===se?void 0:se.invalidCount)>0&&(0,Q.jsxs)(w.A,{severity:"error",sx:{mb:2},children:[se.invalidCount," rows have errors and will be skipped during import."]})]})}),(0,Q.jsx)(C.A,{in:ue.valid,children:(0,Q.jsx)(n.A,{sx:{mb:2},children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"subtitle1",gutterBottom:!0,children:"Valid Rows (First 5)"}),(0,Q.jsx)(u.A,{sx:{maxHeight:300},children:(0,Q.jsxs)(h.A,{size:"small",children:[(0,Q.jsx)(m.A,{children:(0,Q.jsxs)(x.A,{children:[(0,Q.jsx)(y.A,{children:"Row"}),(0,Q.jsx)(y.A,{children:"Name"}),(0,Q.jsx)(y.A,{children:"Email"}),(0,Q.jsx)(y.A,{children:"Phone"}),(0,Q.jsx)(y.A,{children:"Company"}),(0,Q.jsx)(y.A,{children:"Type"})]})}),(0,Q.jsx)(A.A,{children:null===se||void 0===se?void 0:se.validRows.slice(0,5).map((e,t)=>(0,Q.jsxs)(x.A,{children:[(0,Q.jsx)(y.A,{children:e._originalRow}),(0,Q.jsx)(y.A,{children:"".concat(e.firstName||""," ").concat(e.lastName||"").trim()}),(0,Q.jsx)(y.A,{children:e.email||"N/A"}),(0,Q.jsx)(y.A,{children:e.phone||"N/A"}),(0,Q.jsx)(y.A,{children:e.company||"N/A"}),(0,Q.jsx)(y.A,{children:e.type})]},t))})]})})]})})}),(0,Q.jsx)(C.A,{in:ue.invalid,children:(0,Q.jsx)(n.A,{sx:{mb:2},children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"subtitle1",gutterBottom:!0,children:"Invalid Rows"}),(0,Q.jsx)(_.A,{dense:!0,children:null===se||void 0===se?void 0:se.invalidRows.map((e,t)=>{var s;return(0,Q.jsxs)(S.Ay,{children:[(0,Q.jsx)(k.A,{children:(0,Q.jsx)(E.A,{color:"error"})}),(0,Q.jsx)(R.A,{primary:"Row ".concat(e._originalRow),secondary:null===(s=e._errors)||void 0===s?void 0:s.join(", ")})]},t)})})]})})}),(0,Q.jsx)(C.A,{in:ue.warnings,children:(0,Q.jsx)(n.A,{sx:{mb:2},children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"subtitle1",gutterBottom:!0,children:"Warnings"}),(0,Q.jsx)(_.A,{dense:!0,children:null===se||void 0===se?void 0:se.warnings.map((e,t)=>(0,Q.jsxs)(S.Ay,{children:[(0,Q.jsx)(k.A,{children:(0,Q.jsx)(O.A,{color:"warning"})}),(0,Q.jsx)(R.A,{primary:e})]},t))})]})})}),(0,Q.jsxs)(l.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[(0,Q.jsx)(p.A,{variant:"outlined",onClick:()=>s(1),children:"Back to Mapping"}),(0,Q.jsxs)(p.A,{variant:"contained",onClick:ge,disabled:0===(null===se||void 0===se?void 0:se.validCount),children:["Import ",null===se||void 0===se?void 0:se.validCount," Contacts"]})]})]})})(),3===t&&(0,Q.jsx)(n.A,{children:(0,Q.jsxs)(o.A,{children:[(0,Q.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:ae?"Importing Contacts...":"Import Complete"}),ae&&(0,Q.jsxs)(l.A,{sx:{mb:3},children:[(0,Q.jsx)(I.A,{variant:"determinate",value:ne}),(0,Q.jsxs)(c.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Progress: ",Math.round(ne),"%"]})]}),le&&(0,Q.jsxs)(l.A,{children:[(0,Q.jsxs)(w.A,{severity:le.errors>0?"warning":"success",sx:{mb:2},children:["Import completed: ",le.success," successful, ",le.errors," failed"]}),le.errorDetails.length>0&&(0,Q.jsxs)(l.A,{children:[(0,Q.jsx)(c.A,{variant:"subtitle2",gutterBottom:!0,children:"Import Errors:"}),(0,Q.jsx)(_.A,{dense:!0,children:le.errorDetails.map((e,t)=>(0,Q.jsxs)(S.Ay,{children:[(0,Q.jsx)(k.A,{children:(0,Q.jsx)(E.A,{color:"error"})}),(0,Q.jsx)(R.A,{primary:"Row ".concat(e.row),secondary:e.error})]},t))})]}),(0,Q.jsxs)(l.A,{sx:{mt:3,display:"flex",justifyContent:"center",gap:2},children:[(0,Q.jsx)(p.A,{variant:"contained",onClick:()=>e("/contacts"),children:"View Contacts"}),(0,Q.jsx)(p.A,{variant:"outlined",onClick:ve,children:"Import More"})]})]}),!ae&&!le&&(0,Q.jsx)(l.A,{sx:{textAlign:"center"},children:(0,Q.jsx)(p.A,{variant:"contained",onClick:je,startIcon:(0,Q.jsx)(q.A,{}),size:"large",disabled:0===(null===se||void 0===se?void 0:se.validCount),children:"Start Import"})})]})})]}),(0,Q.jsx)(D.A,{open:de.open,autoHideDuration:6e3,onClose:()=>pe((0,r.A)((0,r.A)({},de),{},{open:!1})),children:(0,Q.jsx)(w.A,{onClose:()=>pe((0,r.A)((0,r.A)({},de),{},{open:!1})),severity:de.severity,sx:{width:"100%"},children:de.message})})]})}},39705:(e,t,s)=>{s.d(t,{TP:()=>a});var r=s(94505);const a={getContacts:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),s="/contacts".concat(t?"?".concat(t):"");return(await r.Ay.get(s)).data}catch(t){throw console.error("Error fetching contacts:",t),t}},getContact:async e=>{try{return(await r.Ay.get("/contacts/".concat(e))).data}catch(t){throw console.error("Error fetching contact:",t),t}},createContact:async e=>{try{return(await r.Ay.post("/contacts",e)).data}catch(t){throw console.error("Error creating contact:",t),t}},updateContact:async(e,t)=>{try{return(await r.Ay.put("/contacts/".concat(e),t)).data}catch(s){throw console.error("Error updating contact:",s),s}},deleteContact:async e=>{try{return(await r.Ay.delete("/contacts/".concat(e))).data}catch(t){throw console.error("Error deleting contact:",t),t}}}}}]);
//# sourceMappingURL=5836.b08f3cf0.chunk.js.map