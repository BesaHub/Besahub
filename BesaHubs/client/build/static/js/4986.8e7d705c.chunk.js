"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[4986],{16597:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(65043);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{threshold:t=.1,rootMargin:a="0px",triggerOnce:i=!0,initialVisible:r=!1}=e,s=(0,n.useRef)(null),[o,l]=(0,n.useState)(r);return(0,n.useEffect)(()=>{const e=new IntersectionObserver(t=>{let[a]=t;a.isIntersecting?(l(!0),i&&s.current&&e.unobserve(s.current)):i||l(!1)},{threshold:t,rootMargin:a}),n=s.current;return n&&e.observe(n),()=>{n&&e.unobserve(n)}},[t,a,i]),[s,o]}},42223:(e,t,a)=>{a.d(t,{kx:()=>s,vG:()=>r,vn:()=>o,zb:()=>i});var n=a(94505);const i={getDeals:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deals:",t),t}},getDeal:async e=>{try{return(await n.Ay.get("/deals/".concat(e))).data}catch(t){throw console.error("Error fetching deal:",t),t}},createDeal:async e=>{try{return(await n.Ay.post("/deals",e)).data}catch(t){throw console.error("Error creating deal:",t),t}},updateDeal:async(e,t)=>{try{return(await n.Ay.put("/deals/".concat(e),t)).data}catch(a){throw console.error("Error updating deal:",a),a}},deleteDeal:async e=>{try{return(await n.Ay.delete("/deals/".concat(e))).data}catch(t){throw console.error("Error deleting deal:",t),t}},updateDealStage:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{return(await n.Ay.put("/deals/".concat(e,"/stage"),{stage:t,notes:a})).data}catch(i){throw console.error("Error updating deal stage:",i),i}},addActivity:async(e,t)=>{try{return(await n.Ay.post("/deals/".concat(e,"/activities"),t)).data}catch(a){throw console.error("Error adding deal activity:",a),a}},getDealActivities:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=new URLSearchParams(t).toString(),i="/deals/".concat(e,"/activities").concat(a?"?".concat(a):"");return(await n.Ay.get(i)).data}catch(a){throw console.error("Error fetching deal activities:",a),a}},updateProbability:async(e,t)=>{try{return(await n.Ay.put("/deals/".concat(e,"/probability"),{probability:t})).data}catch(a){throw console.error("Error updating deal probability:",a),a}},getPipelineStats:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/pipeline/stats".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching pipeline stats:",t),t}},getDealsByStage:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/pipeline".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deals by stage:",t),t}},bulkUpdateDeals:async(e,t)=>{try{return(await n.Ay.post("/deals/bulk-update",{dealIds:e,updates:t})).data}catch(a){throw console.error("Error bulk updating deals:",a),a}},duplicateDeal:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return(await n.Ay.post("/deals/".concat(e,"/duplicate"),t)).data}catch(a){throw console.error("Error duplicating deal:",a),a}},exportDeals:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/export".concat(t?"?".concat(t):"");return(await n.Ay.get(a,{responseType:"blob"})).data}catch(t){throw console.error("Error exporting deals:",t),t}},getDealForecast:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/forecast".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching deal forecast:",t),t}},getConversionMetrics:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=new URLSearchParams(e).toString(),a="/deals/metrics/conversion".concat(t?"?".concat(t):"");return(await n.Ay.get(a)).data}catch(t){throw console.error("Error fetching conversion metrics:",t),t}}},r=[{id:"prospecting",name:"Prospecting",description:"Initial contact and qualification",probability:10,color:"#e3f2fd"},{id:"qualification",name:"Qualification",description:"Assessing fit and requirements",probability:25,color:"#f3e5f5"},{id:"proposal",name:"Proposal",description:"Preparing and presenting offer",probability:50,color:"#fff3e0"},{id:"negotiation",name:"Negotiation",description:"Terms and price negotiation",probability:75,color:"#e8f5e8"},{id:"contract",name:"Contract",description:"Finalizing legal agreements",probability:90,color:"#e1f5fe"},{id:"closed_won",name:"Closed Won",description:"Deal successfully completed",probability:100,color:"#e8f5e8"},{id:"closed_lost",name:"Closed Lost",description:"Deal not successful",probability:0,color:"#ffebee"}],s=[{id:"low",name:"Low",color:"#9e9e9e"},{id:"medium",name:"Medium",color:"#ff9800"},{id:"high",name:"High",color:"#f44336"},{id:"urgent",name:"Urgent",color:"#d32f2f"}],o=[{id:"sale",name:"Sale"},{id:"lease",name:"Lease"},{id:"purchase",name:"Purchase"},{id:"sublease",name:"Sublease"},{id:"management",name:"Property Management"},{id:"development",name:"Development"},{id:"investment",name:"Investment"}]},48309:(e,t,a)=>{a.d(t,{A:()=>l});a(65043);var n=a(96446),i=a(85865),r=a(11906),s=a(26240),o=a(70579);const l=e=>{let{icon:t,title:a,message:l,actionLabel:c,onAction:d}=e;const x=(0,s.A)();return(0,o.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:{xs:"300px",sm:"400px",md:"500px"},padding:x.spacing(4),textAlign:"center",animation:"fadeIn 0.6s ease-out","@keyframes fadeIn":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}}},children:[(0,o.jsx)(n.A,{sx:{position:"relative",mb:x.spacing(4),animation:"scaleIn 0.5s ease-out",animationDelay:"0.2s",animationFillMode:"both","@keyframes scaleIn":{from:{transform:"scale(0.8)",opacity:0},to:{transform:"scale(1)",opacity:1}}},children:(0,o.jsx)(n.A,{sx:{width:{xs:80,sm:100,md:120},height:{xs:80,sm:100,md:120},borderRadius:"50%",background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative","&::before":{content:'""',position:"absolute",top:-2,left:-2,right:-2,bottom:-2,background:x.palette.gradient.primary,borderRadius:"50%",zIndex:-1,opacity:.2}},children:t&&(0,o.jsx)(n.A,{sx:{background:x.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)(t,{sx:{fontSize:{xs:40,sm:50,md:60},opacity:1,filter:"drop-shadow(0 2px 4px rgba(102, 126, 234, 0.2))"}})})})}),(0,o.jsxs)(n.A,{sx:{maxWidth:{xs:"100%",sm:500,md:600},mb:x.spacing(2),animation:"fadeInUp 0.6s ease-out",animationDelay:"0.3s",animationFillMode:"both","@keyframes fadeInUp":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}}},children:[(0,o.jsx)(i.A,{variant:"h4",sx:{fontWeight:700,mb:x.spacing(2),background:x.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",fontSize:{xs:"1.5rem",sm:"1.875rem",md:"2.125rem"},letterSpacing:"-0.01em"},children:a}),(0,o.jsx)(i.A,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"},lineHeight:1.6,px:{xs:2,sm:0}},children:l})]}),c&&d&&(0,o.jsx)(n.A,{sx:{animation:"fadeInUp 0.6s ease-out",animationDelay:"0.4s",animationFillMode:"both"},children:(0,o.jsx)(r.A,{variant:"contained",onClick:d,sx:{background:x.palette.gradient.primary,color:"white",padding:{xs:"10px 24px",sm:"12px 32px"},fontSize:{xs:"0.875rem",sm:"1rem"},fontWeight:600,borderRadius:3,textTransform:"none",boxShadow:"0 8px 24px rgba(102, 126, 234, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{background:"linear-gradient(135deg, #5568d3 0%, #653a8b 100%)",boxShadow:"0 12px 32px rgba(102, 126, 234, 0.4)",transform:"translateY(-2px)"},"&:active":{transform:"translateY(0)",boxShadow:"0 6px 16px rgba(102, 126, 234, 0.3)"}},children:c})})]})}},74986:(e,t,a)=>{a.r(t),a.d(t,{default:()=>re});var n=a(89379),i=a(65043),r=a(73216),s=a(26240),o=a(12110),l=a(26494),c=a(51962),d=a(96446),x=a(43845),h=a(17392),p=a(85865),g=a(77739),u=a(81045),m=a(67254),b=a(11906),y=a(68903),A=a(63336),f=a(55263),j=a(78185),v=a(72437),w=a(32143),S=a(2050),k=a(48734),C=a(39336),D=a(83462),z=a(26600),I=a(35316),P=a(53193),W=a(18356),R=a(72221),E=a(67784),F=a(29347),U=a(99070),N=a(73158),M=a(70141),L=a(2780),B=a(15337),T=a(67957),G=a(33438),V=a(83560),_=a(58558),Y=a(59893),q=a(47805),H=a(41209),O=a(31973),J=a(42796),K=a(10529),Q=a(3632),X=a(23585),Z=a(1648),$=a(41024),ee=a(42223),te=a(16597),ae=a(48309),ne=a(70579);const ie=e=>{var t,a,i,r,s,m,b,y;let{deal:A,stage:f,onMenuClick:j,onViewDeal:v,onEditDeal:w,selectedDeals:S,onSelectDeal:k,getPriorityInfo:C,getStageGradient:D,getPriorityGradient:z,theme:I,formatCurrency:P}=e;const{attributes:W,listeners:R,setNodeRef:E,transform:F,transition:U,isDragging:N}=(0,Z.gl)({id:A.id}),M={transform:$.Ks.Transform.toString(F),transition:U,opacity:N?.5:1},L=C(A.priority);return(0,ne.jsx)(o.A,(0,n.A)((0,n.A)((0,n.A)({ref:E,style:M},W),R),{},{sx:{mb:.75,cursor:"grab",borderRadius:2,boxShadow:N?3:1,transform:N?"rotate(5deg)":"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative","&:hover":{boxShadow:3,transform:"translateY(-2px)","& .quick-actions":{opacity:1,visibility:"visible"}}},children:(0,ne.jsxs)(l.A,{sx:{p:1.25,"&:last-child":{pb:1.25}},children:[(0,ne.jsx)(c.A,{checked:S.has(A.id),onChange:e=>k(A.id,e),onClick:e=>e.stopPropagation(),size:"small",sx:{position:"absolute",top:4,left:4,zIndex:10,padding:.5,color:"white","&.Mui-checked":{color:I.palette.gradient.secondary.main}}}),(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[(0,ne.jsx)(x.A,{label:L.name,size:"small",sx:{background:z(A.priority,I),color:"white",fontSize:"0.688rem",height:18,fontWeight:600,backdropFilter:"blur(10px)",border:"none"}}),(0,ne.jsx)(h.A,{size:"small",onClick:e=>{e.stopPropagation(),j(e,A)},sx:{p:.5,transition:"all 0.2s","&:hover":{backgroundColor:"action.hover",transform:"scale(1.1)"}},children:(0,ne.jsx)(_.A,{sx:{fontSize:16}})})]}),(0,ne.jsx)(p.A,{variant:"caption",sx:{fontWeight:600,fontSize:"0.875rem",mb:.5,display:"block",cursor:"pointer",transition:"color 0.2s","&:hover":{background:I.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}},onClick:e=>{e.stopPropagation(),v(A)},children:A.name}),(0,ne.jsx)(p.A,{variant:"subtitle1",sx:{background:I.palette.gradient.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:700,fontSize:"1rem",mb:.5},children:P(A.value)}),(0,ne.jsxs)(d.A,{sx:{mb:.5},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.25},children:[(0,ne.jsx)(p.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:"Probability"}),(0,ne.jsxs)(p.A,{variant:"caption",sx:{fontWeight:600,fontSize:"0.688rem"},children:[A.probability,"%"]})]}),(0,ne.jsx)(d.A,{sx:{height:4,borderRadius:2,background:"rgba(0, 0, 0, 0.1)",overflow:"hidden"},children:(0,ne.jsx)(d.A,{sx:{height:"100%",width:"".concat(A.probability,"%"),background:I.palette.gradient.success,transition:"width 0.3s ease"}})})]}),(0,ne.jsxs)(d.A,{className:"quick-actions",sx:{display:"flex",gap:.5,mt:.5,opacity:0,visibility:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,ne.jsx)(g.A,{title:"View Deal",children:(0,ne.jsx)(h.A,{size:"small",onClick:e=>{e.stopPropagation(),v(A)},sx:{flex:1,borderRadius:1.5,p:.5,background:I.palette.gradient.info,color:"white","&:hover":{background:I.palette.gradient.info,opacity:.9}},children:(0,ne.jsx)(Q.A,{sx:{fontSize:14}})})}),(0,ne.jsx)(g.A,{title:"Edit Deal",children:(0,ne.jsx)(h.A,{size:"small",onClick:e=>{e.stopPropagation(),w(A)},sx:{flex:1,borderRadius:1.5,p:.5,background:I.palette.gradient.warning,color:"white","&:hover":{background:I.palette.gradient.warning,opacity:.9}},children:(0,ne.jsx)(V.A,{sx:{fontSize:14}})})})]}),(0,ne.jsx)(d.A,{sx:{mt:.5,mb:.5},children:(0,ne.jsx)(x.A,{label:f.name,size:"small",sx:{background:D(f.id,I),color:"white",fontSize:"0.688rem",height:18,fontWeight:600,backdropFilter:"blur(10px)"}})}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mb:.5},children:[(0,ne.jsx)(Y.A,{sx:{fontSize:12,mr:.5,color:"text.secondary"}}),(0,ne.jsx)(p.A,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.688rem"},children:"company"===(null===(t=A.contact)||void 0===t?void 0:t.type)?null===(a=A.contact)||void 0===a?void 0:a.companyName:"".concat(null===(i=A.contact)||void 0===i?void 0:i.firstName," ").concat(null===(r=A.contact)||void 0===r?void 0:r.lastName)})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mb:.5},children:[(0,ne.jsx)(H.A,{sx:{fontSize:12,mr:.5,color:"text.secondary"}}),(0,ne.jsx)(p.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:new Date(A.expectedCloseDate).toLocaleDateString()})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(u.A,{sx:{width:16,height:16,mr:.5,fontSize:"0.625rem"},children:null===(s=A.assignedTo)||void 0===s||null===(m=s.firstName)||void 0===m?void 0:m[0]}),(0,ne.jsxs)(p.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.688rem"},children:[null===(b=A.assignedTo)||void 0===b?void 0:b.firstName," ",null===(y=A.assignedTo)||void 0===y?void 0:y.lastName]})]})]})}))},re=()=>{const e=(0,r.Zp)(),t=(0,s.A)(),[a,x]=(0,te.A)({threshold:.1}),[u,_]=(0,i.useState)({}),[Y,H]=(0,i.useState)(!0),[$,re]=(0,i.useState)(null),[se,oe]=(0,i.useState)({open:!1,message:"",severity:"success"}),[le,ce]=(0,i.useState)({element:null,deal:null}),[de,xe]=(0,i.useState)({open:!1,deal:null,newStage:"",notes:""}),[he,pe]=(0,i.useState)({open:!1,deal:null,probability:50}),[ge,ue]=(0,i.useState)({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0}),[me,be]=(0,i.useState)(new Set),[ye,Ae]=(0,i.useState)(!1),[fe,je]=(0,i.useState)({type:"",value:""}),ve=(0,X.FR)((0,X.MS)(X.AN),(0,X.MS)(X.uN,{coordinateGetter:Z.JR})),we=(0,i.useCallback)(async()=>{try{H(!0),re(null);const[e,t]=await Promise.all([ee.zb.getDealsByStage(),ee.zb.getPipelineStats()]);e&&e.dealsByStage?_(e.dealsByStage):_({}),t&&t.stats?ue(t.stats):ue({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0})}catch(e){console.error("Failed to load pipeline data:",e),_({}),ue({totalValue:0,totalDeals:0,averageDealSize:0,winRate:0}),oe({open:!0,message:"Failed to load pipeline data. Please try again.",severity:"error"})}finally{H(!1)}},[]);(0,i.useEffect)(()=>{we()},[we]);const Se=(0,i.useCallback)(async e=>{const{active:t,over:a}=e;if(!a||t.id===a.id)return;const i=t.id,r=a.id;let s=null,o=-1,l=null;for(const[n,b]of Object.entries(u)){const e=b.findIndex(e=>String(e.id)===i);if(-1!==e){s=n,o=e,l=b[e];break}}if(!l||!s)return;let c=s;r!==s&&ee.vG.some(e=>e.id===r)&&(c=r);const d={};Object.keys(u).forEach(e=>{d[e]=[...u[e]||[]]});const[x]=d[s].splice(o,1),h=ee.vG.find(e=>e.id===c),p=(0,n.A)((0,n.A)({},x),{},{stage:c,probability:h?h.probability:x.probability});d[c]=d[c]||[],d[c].push(p);const g=u;_(d);try{await ee.zb.updateDealStage(x.id,c,"Moved from ".concat(s," to ").concat(c)),oe({open:!0,message:"Deal moved to ".concat((null===h||void 0===h?void 0:h.name)||c),severity:"success"})}catch(m){_(g),oe({open:!0,message:"Failed to update deal stage",severity:"error"})}},[u]),ke=(0,i.useCallback)((e,t)=>{ce({element:e.currentTarget,deal:t})},[]),Ce=(0,i.useCallback)(()=>{ce({element:null,deal:null})},[]),De=(0,i.useCallback)(t=>{e("/deals/".concat(t.id))},[e]),ze=(0,i.useCallback)(t=>{e("/deals/".concat(t.id,"/edit"))},[e]),Ie=(0,i.useCallback)(e=>{xe({open:!0,deal:e,newStage:e.stage,notes:""}),ce({element:null,deal:null})},[]),Pe=(0,i.useCallback)(e=>{pe({open:!0,deal:e,probability:e.probability}),ce({element:null,deal:null})},[]),We=(0,i.useCallback)((e,t)=>{t.stopPropagation(),be(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),Re=(0,i.useCallback)(e=>{const t=(u[e]||[]).map(e=>e.id);be(e=>{const a=new Set(e);return t.every(e=>a.has(e))?t.forEach(e=>a.delete(e)):t.forEach(e=>a.add(e)),a})},[u]),Ee=(0,i.useCallback)(e=>{je({type:"stage",value:e}),Ae(!0)},[]),Fe=(0,i.useCallback)(()=>{je({type:"delete",value:null}),Ae(!0)},[]),Ue=(0,i.useCallback)(async()=>{const e=Array.from(me);if(0!==e.length)try{let t={};"stage"===fe.type?t.stage=fe.value:"delete"===fe.type&&(t.status="archived");const a=await ee.zb.bulkUpdateDeals(e,t);a.success?(await we(),oe({open:!0,message:"Successfully updated ".concat(a.updated," deal(s)"),severity:"success"}),be(new Set),Ae(!1)):oe({open:!0,message:a.message||"Bulk update failed",severity:"error"})}catch(t){console.error("Bulk update error:",t),oe({open:!0,message:"Failed to update deals. Please try again.",severity:"error"})}},[me,fe,we]),Ne=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Me=e=>ee.kx.find(t=>t.id===e)||ee.kx[0],Le=(e,t)=>({prospecting:t.palette.gradient.info,qualification:t.palette.gradient.primary,proposal:t.palette.gradient.warning,negotiation:t.palette.gradient.secondary,contract:t.palette.gradient.success,closed_won:t.palette.gradient.success,closed_lost:t.palette.gradient.secondary}[e]||t.palette.gradient.primary),Be=(e,t)=>({high:t.palette.gradient.warning,medium:t.palette.gradient.info,low:t.palette.gradient.secondary}[e]||t.palette.gradient.secondary),Te=!Y&&Object.keys(u).every(e=>{const t=u[e];return!t||0===t.length});return $?(0,ne.jsxs)(d.A,{children:[(0,ne.jsxs)(m.A,{severity:"error",sx:{mb:2},children:[(0,ne.jsx)(p.A,{variant:"h6",children:"Failed to load pipeline"}),(0,ne.jsx)(p.A,{children:$})]}),(0,ne.jsx)(b.A,{variant:"contained",onClick:()=>window.location.reload(),sx:{mt:2},children:"Retry"})]}):(0,ne.jsxs)(d.A,{children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,animation:"fadeInScale 0.6s ease-out"},children:[(0,ne.jsx)(p.A,{variant:"h4",sx:{fontWeight:700},children:"Sales Pipeline"}),(0,ne.jsxs)(d.A,{sx:{display:"flex",gap:1},children:[(0,ne.jsx)(b.A,{variant:"outlined",startIcon:(0,ne.jsx)(K.A,{}),onClick:()=>e("/deals"),children:"List View"}),(0,ne.jsx)(b.A,{variant:"outlined",onClick:we,disabled:Y,startIcon:(0,ne.jsx)(q.A,{className:"icon-spin-hover"}),children:"Refresh"}),(0,ne.jsx)(b.A,{variant:"contained",startIcon:(0,ne.jsx)(M.A,{}),onClick:()=>e("/deals/new"),children:"Add Deal"})]})]}),(0,ne.jsx)(d.A,{ref:a,sx:{opacity:x?1:0,transform:x?"translateY(0)":"translateY(30px)",transition:"all 0.6s ease-out"},children:(0,ne.jsxs)(y.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,ne.jsx)(y.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(A.A,{sx:{p:2,textAlign:"center"},children:[(0,ne.jsx)(p.A,{variant:"h4",sx:{fontWeight:700,color:"primary.main"},children:Ne(ge.totalValue)}),(0,ne.jsx)(p.A,{variant:"body2",color:"text.secondary",children:"Total Pipeline Value"})]})}),(0,ne.jsx)(y.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(A.A,{sx:{p:2,textAlign:"center"},children:[(0,ne.jsx)(p.A,{variant:"h4",sx:{fontWeight:700,color:"info.main"},children:ge.totalDeals}),(0,ne.jsx)(p.A,{variant:"body2",color:"text.secondary",children:"Active Deals"})]})}),(0,ne.jsx)(y.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(A.A,{sx:{p:2,textAlign:"center"},children:[(0,ne.jsx)(p.A,{variant:"h4",sx:{fontWeight:700,color:"success.main"},children:Ne(ge.averageDealSize)}),(0,ne.jsx)(p.A,{variant:"body2",color:"text.secondary",children:"Average Deal Size"})]})}),(0,ne.jsx)(y.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(A.A,{sx:{p:2,textAlign:"center"},children:[(0,ne.jsxs)(p.A,{variant:"h4",sx:{fontWeight:700,color:"warning.main"},children:[ge.winRate.toFixed(1),"%"]}),(0,ne.jsx)(p.A,{variant:"body2",color:"text.secondary",children:"Win Rate"})]})})]})}),Te&&(0,ne.jsx)(ae.A,{icon:B.A,title:"No deals in pipeline",message:"Get started by creating your first deal to track your opportunities",actionLabel:"Add Deal",onAction:()=>e("/deals/new")}),!Te&&(0,ne.jsxs)(ne.Fragment,{children:[me.size>0&&(0,ne.jsx)(A.A,{elevation:10,sx:{position:"sticky",top:16,zIndex:1e3,mb:3,background:"linear-gradient(135deg, ".concat(t.palette.gradient.primary.main,", ").concat(t.palette.gradient.primary.light,")"),borderRadius:"12px",overflow:"hidden",animation:"fadeInUp 0.3s ease-out"},children:(0,ne.jsxs)(f.A,{children:[(0,ne.jsxs)(p.A,{variant:"h6",sx:{flex:1,color:"white"},children:[me.size," deal",1!==me.size?"s":""," selected"]}),(0,ne.jsx)(g.A,{title:"Change Stage",children:(0,ne.jsx)(h.A,{onClick:()=>Ee("qualification"),sx:{color:"white",mr:1},children:(0,ne.jsx)(O.A,{})})}),(0,ne.jsx)(g.A,{title:"Archive Selected",children:(0,ne.jsx)(h.A,{onClick:Fe,sx:{color:"white"},children:(0,ne.jsx)(L.A,{})})}),(0,ne.jsx)(g.A,{title:"Clear Selection",children:(0,ne.jsx)(h.A,{onClick:()=>be(new Set),sx:{color:"white",ml:2},children:(0,ne.jsx)(G.A,{})})})]})}),(0,ne.jsx)(X.Mp,{sensors:ve,collisionDetection:X.fp,onDragEnd:Se,children:(0,ne.jsx)(d.A,{sx:{display:"flex",gap:2,overflowX:"auto",pb:2},children:ee.vG.filter(e=>"closed_lost"!==e.id).map(e=>{const a=u[e.id]||[],n=a.reduce((e,t)=>e+t.value,0);return(0,ne.jsxs)(A.A,{sx:{minWidth:280,maxWidth:280,borderRadius:3,boxShadow:2,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[(0,ne.jsxs)(d.A,{sx:{p:1.25,background:Le(e.id,t),color:"white"},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[(0,ne.jsx)(p.A,{variant:"subtitle1",sx:{fontWeight:600,color:"white",fontSize:"0.938rem"},children:e.name}),!Y&&a.length>0&&(0,ne.jsx)(g.A,{title:"Select all deals in this stage",children:(0,ne.jsx)(c.A,{checked:a.length>0&&a.every(e=>me.has(e.id)),indeterminate:a.some(e=>me.has(e.id))&&!a.every(e=>me.has(e.id)),onChange:()=>Re(e.id),sx:{color:"rgba(255, 255, 255, 0.7)","&.Mui-checked":{color:"white"},"&.MuiCheckbox-indeterminate":{color:"white"}}})})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ne.jsx)(p.A,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.9)",fontSize:"0.813rem"},children:Y?"-":"".concat(a.length," deal").concat(1!==a.length?"s":"")}),(0,ne.jsx)(p.A,{variant:"caption",sx:{fontWeight:600,color:"white",fontSize:"0.813rem"},children:Y?"-":Ne(n)})]})]}),(0,ne.jsx)(Z.gB,{items:a.map(e=>e.id),strategy:Z._G,children:(0,ne.jsx)(d.A,{sx:{minHeight:200,maxHeight:600,overflowY:"auto",p:.75,backgroundColor:"transparent"},children:Y?[...Array(2)].map((e,t)=>(0,ne.jsx)(o.A,{sx:{mb:.75,borderRadius:2,boxShadow:1},children:(0,ne.jsxs)(l.A,{sx:{p:1.25,"&:last-child":{pb:1.25}},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,ne.jsx)(j.A,{variant:"rounded",width:60,height:20,animation:"wave",sx:{borderRadius:2}}),(0,ne.jsx)(j.A,{variant:"circular",width:24,height:24,animation:"wave"})]}),(0,ne.jsx)(j.A,{variant:"text",width:"80%",height:24,animation:"wave",sx:{mb:1}}),(0,ne.jsx)(j.A,{variant:"text",width:"50%",height:32,animation:"wave",sx:{mb:1}}),(0,ne.jsxs)(d.A,{sx:{mb:1},children:[(0,ne.jsx)(j.A,{variant:"text",width:"100%",height:16,animation:"wave",sx:{mb:.5}}),(0,ne.jsx)(j.A,{variant:"rounded",width:"100%",height:6,animation:"wave",sx:{borderRadius:3}})]}),(0,ne.jsx)(j.A,{variant:"text",width:"70%",height:16,animation:"wave",sx:{mb:.5}}),(0,ne.jsx)(j.A,{variant:"text",width:"60%",height:16,animation:"wave"})]})},"skeleton-".concat(t))):0===a.length?(0,ne.jsxs)(d.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4,px:2},children:[(0,ne.jsx)(p.A,{variant:"body2",color:"text.secondary",align:"center",children:"No deals in this stage"}),(0,ne.jsx)(p.A,{variant:"caption",color:"text.secondary",align:"center",sx:{mt:.5},children:"Drag deals here to update their stage"})]}):a.map(a=>(0,ne.jsx)(ie,{deal:a,stage:e,onMenuClick:ke,onViewDeal:De,onEditDeal:ze,selectedDeals:me,onSelectDeal:We,getPriorityInfo:Me,getStageGradient:Le,getPriorityGradient:Be,theme:t,formatCurrency:Ne},a.id))})})]},e.id)})})})]}),(0,ne.jsxs)(v.A,{anchorEl:le.element,open:Boolean(le.element),onClose:Ce,children:[(0,ne.jsxs)(w.A,{onClick:()=>{De(le.deal),Ce()},children:[(0,ne.jsx)(S.A,{children:(0,ne.jsx)(Q.A,{fontSize:"small"})}),(0,ne.jsx)(k.A,{children:"View Details"})]}),(0,ne.jsxs)(w.A,{onClick:()=>{ze(le.deal),Ce()},children:[(0,ne.jsx)(S.A,{children:(0,ne.jsx)(V.A,{fontSize:"small"})}),(0,ne.jsx)(k.A,{children:"Edit Deal"})]}),(0,ne.jsx)(C.A,{}),(0,ne.jsxs)(w.A,{onClick:()=>Ie(le.deal),children:[(0,ne.jsx)(S.A,{children:(0,ne.jsx)(J.A,{fontSize:"small"})}),(0,ne.jsx)(k.A,{children:"Update Stage"})]}),(0,ne.jsxs)(w.A,{onClick:()=>Pe(le.deal),children:[(0,ne.jsx)(S.A,{children:(0,ne.jsx)(T.A,{fontSize:"small"})}),(0,ne.jsx)(k.A,{children:"Update Probability"})]})]}),(0,ne.jsxs)(D.A,{open:de.open,onClose:()=>xe({open:!1,deal:null,newStage:"",notes:""}),children:[(0,ne.jsx)(z.A,{children:"Update Deal Stage"}),(0,ne.jsx)(I.A,{sx:{minWidth:400},children:(0,ne.jsxs)(d.A,{sx:{pt:1},children:[(0,ne.jsxs)(P.A,{fullWidth:!0,sx:{mb:2},children:[(0,ne.jsx)(W.A,{children:"New Stage"}),(0,ne.jsx)(R.A,{value:de.newStage,label:"New Stage",onChange:e=>xe(t=>(0,n.A)((0,n.A)({},t),{},{newStage:e.target.value})),children:ee.vG.filter(e=>"closed_lost"!==e.id).map(e=>(0,ne.jsxs)(w.A,{value:e.id,children:[e.name," (",e.probability,"%)"]},e.id))})]}),(0,ne.jsx)(E.A,{fullWidth:!0,label:"Notes (optional)",multiline:!0,rows:3,value:de.notes,onChange:e=>xe(t=>(0,n.A)((0,n.A)({},t),{},{notes:e.target.value})),helperText:"Add any notes about this stage change"})]})}),(0,ne.jsxs)(F.A,{children:[(0,ne.jsx)(b.A,{onClick:()=>xe({open:!1,deal:null,newStage:"",notes:""}),children:"Cancel"}),(0,ne.jsx)(b.A,{onClick:async()=>{try{await ee.zb.updateDealStage(de.deal.id,de.newStage,de.notes);const t=(0,n.A)({},u),a=de.deal.stage,i=de.newStage;if(a!==i){var e;t[a]=t[a].filter(e=>e.id!==de.deal.id);const r=(0,n.A)((0,n.A)({},de.deal),{},{stage:i,probability:(null===(e=ee.vG.find(e=>e.id===i))||void 0===e?void 0:e.probability)||de.deal.probability});t[i]=t[i]||[],t[i].push(r),_(t)}oe({open:!0,message:"Deal stage updated successfully",severity:"success"})}catch(t){oe({open:!0,message:"Failed to update deal stage",severity:"error"})}xe({open:!1,deal:null,newStage:"",notes:""})},variant:"contained",children:"Update Stage"})]})]}),(0,ne.jsxs)(D.A,{open:he.open,onClose:()=>pe({open:!1,deal:null,probability:50}),children:[(0,ne.jsx)(z.A,{children:"Update Deal Probability"}),(0,ne.jsx)(I.A,{sx:{minWidth:400},children:(0,ne.jsxs)(d.A,{sx:{pt:2},children:[(0,ne.jsxs)(p.A,{gutterBottom:!0,children:["Probability: ",he.probability,"%"]}),(0,ne.jsx)(U.Ay,{value:he.probability,onChange:(e,t)=>pe(e=>(0,n.A)((0,n.A)({},e),{},{probability:t})),valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:100,sx:{mb:2}}),(0,ne.jsx)(p.A,{variant:"caption",color:"text.secondary",children:"Adjust the likelihood of this deal closing successfully"})]})}),(0,ne.jsxs)(F.A,{children:[(0,ne.jsx)(b.A,{onClick:()=>pe({open:!1,deal:null,probability:50}),children:"Cancel"}),(0,ne.jsx)(b.A,{onClick:async()=>{try{await ee.zb.updateProbability(he.deal.id,he.probability);const e=(0,n.A)({},u),t=he.deal.stage,a=e[t].findIndex(e=>e.id===he.deal.id);-1!==a&&(e[t][a].probability=he.probability,_(e)),oe({open:!0,message:"Deal probability updated successfully",severity:"success"})}catch(e){oe({open:!0,message:"Failed to update deal probability",severity:"error"})}pe({open:!1,deal:null,probability:50})},variant:"contained",children:"Update Probability"})]})]}),(0,ne.jsxs)(D.A,{open:ye,onClose:()=>Ae(!1),children:[(0,ne.jsx)(z.A,{children:"Confirm Bulk Action"}),(0,ne.jsx)(I.A,{children:(0,ne.jsxs)(p.A,{children:["stage"===fe.type&&"Change stage to ".concat(fe.value," for ").concat(me.size," deal(s)?"),"delete"===fe.type&&"Archive ".concat(me.size," deal(s)?")]})}),(0,ne.jsxs)(F.A,{children:[(0,ne.jsx)(b.A,{onClick:()=>Ae(!1),children:"Cancel"}),(0,ne.jsx)(b.A,{onClick:Ue,variant:"contained",color:"primary",children:"Confirm"})]})]}),(0,ne.jsx)(N.A,{open:se.open,autoHideDuration:6e3,onClose:()=>oe((0,n.A)((0,n.A)({},se),{},{open:!1})),children:(0,ne.jsx)(m.A,{onClose:()=>oe((0,n.A)((0,n.A)({},se),{},{open:!1})),severity:se.severity,sx:{width:"100%"},children:se.message})})]})}}}]);
//# sourceMappingURL=4986.8e7d705c.chunk.js.map