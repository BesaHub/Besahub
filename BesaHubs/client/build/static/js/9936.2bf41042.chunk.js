"use strict";(self.webpackChunkcre_crm_client=self.webpackChunkcre_crm_client||[]).push([[9936],{42796:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(66734),i=s(70579);const r=(0,a.A)((0,i.jsx)("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp")},73166:(e,t,s)=>{s.d(t,{i:()=>r});var a=s(89379),i=s(94505);const r={getAgents:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=(0,a.A)((0,a.A)({},e),{},{role:e.role||void 0,department:e.department||void 0,isActive:void 0!==e.isActive?e.isActive:void 0});Object.keys(t).forEach(e=>void 0===t[e]&&delete t[e]);const s=new URLSearchParams(t).toString(),r="/users".concat(s?"?".concat(s):"");return(await i.Ay.get(r)).data}catch(t){throw console.error("Error fetching agents:",t),t}},getAgentById:async e=>{try{return(await i.Ay.get("/users/".concat(e))).data}catch(t){throw console.error("Error fetching agent:",t),t}},getAgentDashboard:async e=>{try{return(await i.Ay.get("/users/".concat(e,"/dashboard"))).data}catch(t){throw console.error("Error fetching agent dashboard:",t),t}},getAgentPerformance:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const s=new URLSearchParams(t).toString(),a="/users/".concat(e,"/dashboard").concat(s?"?".concat(s):"");return(await i.Ay.get(a)).data}catch(s){throw console.error("Error fetching agent performance:",s),s}}}},99936:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var a=s(89379),i=s(65043),r=s(26240),n=s(19252),l=s(96446),o=s(85865),c=s(11906),d=s(63336),x=s(68903),h=s(67784),v=s(51787),A=s(53193),u=s(18356),p=s(72221),m=s(32143),g=s(81637),j=s(12110),f=s(26494),y=s(81045),w=s(43845),b=s(33691),C=s(73158),S=s(67254),z=s(47805),D=s(79484),R=s(75155),k=s(84770),W=s(42796),L=s(66734),I=s(70579);const P=(0,L.A)((0,I.jsx)("path",{d:"M20 0H4v2h16zM4 24h16v-2H4zM20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m-8 2.75c1.24 0 2.25 1.01 2.25 2.25s-1.01 2.25-2.25 2.25S9.75 10.24 9.75 9 10.76 6.75 12 6.75M17 17H7v-1.5c0-1.67 3.33-2.5 5-2.5s5 .83 5 2.5z"}),"Contacts");var N=s(15337),F=s(73216),M=s(73166),B=s(35016);const E=()=>{const e=(0,r.A)(),t=(0,F.Zp)(),{user:s}=(0,B.h)(),[L,E]=(0,i.useState)([]),[O,T]=(0,i.useState)(!0),[H,_]=(0,i.useState)(""),[U,V]=(0,i.useState)(""),[Y,Z]=(0,i.useState)(""),[q,G]=(0,i.useState)("active"),[J,K]=(0,i.useState)("name"),[Q,X]=(0,i.useState)("asc"),[$,ee]=(0,i.useState)(1),[te,se]=(0,i.useState)({open:!1,message:"",severity:"success"});(0,i.useEffect)(()=>{ae()},[]);const ae=async()=>{try{T(!0);const e=(await M.i.getAgents({page:1,limit:100,isActive:"active"===q||"inactive"!==q&&void 0})).users||[],t=await Promise.all(e.filter(e=>["agent","manager","admin"].includes(e.role)).map(async e=>{try{var t,s,i,r,n,l,o;const c=await M.i.getAgentDashboard(e.id);return(0,a.A)((0,a.A)({},e),{},{activeProperties:(null===(t=c.stats)||void 0===t?void 0:t.activeProperties)||0,activeDeals:(null===(s=c.stats)||void 0===s?void 0:s.activeDeals)||0,totalContacts:(null===(i=c.stats)||void 0===i?void 0:i.totalContacts)||0,wonDeals:(null===(r=c.stats)||void 0===r?void 0:r.wonDeals)||0,totalDeals:(null===(n=c.stats)||void 0===n?void 0:n.totalDeals)||0,winRate:(null===(l=c.stats)||void 0===l?void 0:l.totalDeals)>0?(((null===(o=c.stats)||void 0===o?void 0:o.wonDeals)||0)/c.stats.totalDeals*100).toFixed(1):0})}catch(c){return(0,a.A)((0,a.A)({},e),{},{activeProperties:0,activeDeals:0,totalContacts:0,wonDeals:0,totalDeals:0,winRate:0})}}));E(t)}catch(e){console.error("Failed to fetch agents:",e),se({open:!0,message:"Failed to load agents. Please try again.",severity:"error"})}finally{T(!1)}},ie=(0,i.useMemo)(()=>{let e=L.filter(e=>{var t,s,a,i,r;const n=!H||(null===(t=e.firstName)||void 0===t?void 0:t.toLowerCase().includes(H.toLowerCase()))||(null===(s=e.lastName)||void 0===s?void 0:s.toLowerCase().includes(H.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(H.toLowerCase()))||(null===(i=e.title)||void 0===i?void 0:i.toLowerCase().includes(H.toLowerCase()))||(null===(r=e.department)||void 0===r?void 0:r.toLowerCase().includes(H.toLowerCase())),l=!U||e.role===U,o=!Y||e.department===Y,c="all"===q||"active"===q&&e.isActive||"inactive"===q&&!e.isActive;return n&&l&&o&&c});return e.sort((e,t)=>{let s,a;switch(J){case"name":s="".concat(e.firstName||""," ").concat(e.lastName||"").trim(),a="".concat(t.firstName||""," ").concat(t.lastName||"").trim();break;case"properties":s=e.activeProperties||0,a=t.activeProperties||0;break;case"deals":s=e.activeDeals||0,a=t.activeDeals||0;break;case"contacts":s=e.totalContacts||0,a=t.totalContacts||0;break;case"winRate":s=parseFloat(e.winRate)||0,a=parseFloat(t.winRate)||0;break;default:return 0}return"string"===typeof s?"asc"===Q?s.localeCompare(a):a.localeCompare(s):s<a?"asc"===Q?-1:1:s>a?"asc"===Q?1:-1:0}),e},[L,H,U,Y,q,J,Q]),re=(0,i.useMemo)(()=>{const e=12*($-1),t=e+12;return ie.slice(e,t)},[ie,$,12]),ne=Math.ceil(ie.length/12);(0,i.useEffect)(()=>{$>ne&&ne>0&&ee(1)},[$,ne]);const le=(0,i.useCallback)(e=>{t("/agents/".concat(e.id))},[t]),oe=(0,i.useCallback)((e,t)=>{ee(t),window.scrollTo({top:0,behavior:"smooth"})},[]),ce=()=>{_(""),V(""),Z(""),G("active"),K("name"),X("asc")},de=[...new Set(L.map(e=>e.department).filter(Boolean))].sort(),xe=[H,U,Y,"active"!==q?q:null].filter(Boolean).length;return(0,I.jsxs)(n.A,{maxWidth:"xl",sx:{py:e.spacing(2)},children:[(0,I.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:e.spacing(2)},children:[(0,I.jsxs)(l.A,{children:[(0,I.jsx)(o.A,{variant:"h5",sx:{fontWeight:700,mb:0},children:"Team & Agents"}),(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:[ie.length," agents found"]})]}),(0,I.jsx)(l.A,{sx:{display:"flex",gap:e.spacing(1)},children:(0,I.jsx)(c.A,{variant:"outlined",onClick:async()=>{await ae(),se({open:!0,message:"Agents data refreshed successfully",severity:"success"})},disabled:O,sx:{borderRadius:3},startIcon:(0,I.jsx)(z.A,{className:"icon-spin-hover"}),children:"Refresh"})})]}),(0,I.jsxs)(d.A,{elevation:2,sx:{py:1,px:1.5,mb:e.spacing(2),borderRadius:3},children:[(0,I.jsxs)(x.Ay,{container:!0,spacing:1,alignItems:"center",children:[(0,I.jsx)(x.Ay,{item:!0,xs:12,md:3,children:(0,I.jsx)(h.A,{fullWidth:!0,size:"small",placeholder:"Search agents...",value:H,onChange:e=>_(e.target.value),InputProps:{startAdornment:(0,I.jsx)(v.A,{position:"start",children:(0,I.jsx)(D.A,{})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3}}})}),(0,I.jsx)(x.Ay,{item:!0,xs:12,md:2,children:(0,I.jsxs)(A.A,{fullWidth:!0,size:"small",children:[(0,I.jsx)(u.A,{children:"Role"}),(0,I.jsxs)(p.A,{value:U,label:"Role",onChange:e=>V(e.target.value),sx:{borderRadius:3},children:[(0,I.jsx)(m.A,{value:"",children:"All Roles"}),(0,I.jsx)(m.A,{value:"admin",children:"Admin"}),(0,I.jsx)(m.A,{value:"manager",children:"Manager"}),(0,I.jsx)(m.A,{value:"agent",children:"Agent"})]})]})}),(0,I.jsx)(x.Ay,{item:!0,xs:12,md:2,children:(0,I.jsxs)(A.A,{fullWidth:!0,size:"small",children:[(0,I.jsx)(u.A,{children:"Department"}),(0,I.jsxs)(p.A,{value:Y,label:"Department",onChange:e=>Z(e.target.value),sx:{borderRadius:3},children:[(0,I.jsx)(m.A,{value:"",children:"All Departments"}),de.map(e=>(0,I.jsx)(m.A,{value:e,children:e},e))]})]})}),(0,I.jsx)(x.Ay,{item:!0,xs:12,md:2,children:(0,I.jsxs)(A.A,{fullWidth:!0,size:"small",children:[(0,I.jsx)(u.A,{children:"Status"}),(0,I.jsxs)(p.A,{value:q,label:"Status",onChange:e=>G(e.target.value),sx:{borderRadius:3},children:[(0,I.jsx)(m.A,{value:"all",children:"All Status"}),(0,I.jsx)(m.A,{value:"active",children:"Active"}),(0,I.jsx)(m.A,{value:"inactive",children:"Inactive"})]})]})}),(0,I.jsx)(x.Ay,{item:!0,xs:12,md:2,children:(0,I.jsxs)(A.A,{fullWidth:!0,size:"small",children:[(0,I.jsx)(u.A,{children:"Sort By"}),(0,I.jsxs)(p.A,{value:J,label:"Sort By",onChange:e=>K(e.target.value),sx:{borderRadius:3},children:[(0,I.jsx)(m.A,{value:"name",children:"Name"}),(0,I.jsx)(m.A,{value:"properties",children:"Properties"}),(0,I.jsx)(m.A,{value:"deals",children:"Deals"}),(0,I.jsx)(m.A,{value:"contacts",children:"Contacts"}),(0,I.jsx)(m.A,{value:"winRate",children:"Win Rate"})]})]})}),(0,I.jsx)(x.Ay,{item:!0,xs:12,md:1,children:(0,I.jsx)(c.A,{variant:"outlined",onClick:()=>X("asc"===Q?"desc":"asc"),size:"large",sx:{minWidth:"auto",px:1},children:"asc"===Q?"\u2191":"\u2193"})})]}),xe>0&&(0,I.jsxs)(l.A,{sx:{mt:1,display:"flex",alignItems:"center",gap:1},children:[(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",children:[xe," filter",xe>1?"s":""," active"]}),(0,I.jsx)(c.A,{size:"small",onClick:ce,children:"Clear All"})]})]}),O?(0,I.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",py:8},children:(0,I.jsx)(g.A,{size:60})}):0===re.length?(0,I.jsxs)(d.A,{sx:{p:6,textAlign:"center"},children:[(0,I.jsx)(R.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,I.jsx)(o.A,{variant:"h6",color:"text.secondary",children:"No agents found"}),(0,I.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Try adjusting your filters or search criteria"}),xe>0&&(0,I.jsx)(c.A,{onClick:ce,sx:{mt:2},children:"Clear Filters"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.Ay,{container:!0,spacing:2,children:re.map(t=>{var s,a,i,r;return(0,I.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,I.jsx)(j.A,{sx:{cursor:"pointer",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:4}},onClick:()=>le(t),children:(0,I.jsxs)(f.A,{children:[(0,I.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,I.jsxs)(y.A,{sx:{width:56,height:56,mr:2,bgcolor:"primary.main"},children:[null===(s=t.firstName)||void 0===s?void 0:s.charAt(0),null===(a=t.lastName)||void 0===a?void 0:a.charAt(0)]}),(0,I.jsxs)(l.A,{sx:{flex:1,minWidth:0},children:[(0,I.jsxs)(o.A,{variant:"subtitle1",sx:{fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.firstName," ",t.lastName]}),(0,I.jsx)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title||"Agent"})]})]}),(0,I.jsxs)(l.A,{sx:{display:"flex",gap:.5,mb:2,flexWrap:"wrap"},children:[(0,I.jsx)(w.A,{label:t.role,size:"small",color:(r=t.role,{admin:"error",manager:"warning",agent:"primary",assistant:"default"}[r]||"default")}),!t.isActive&&(0,I.jsx)(w.A,{label:"Inactive",size:"small",color:"default"})]}),(0,I.jsxs)(l.A,{sx:{mb:2},children:[t.department&&(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:[(0,I.jsx)(k.A,{sx:{fontSize:14,verticalAlign:"middle",mr:.5}}),t.department]}),(0,I.jsx)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.email})]}),(0,I.jsxs)(l.A,{sx:{pt:2,borderTop:"1px solid ".concat(e.palette.divider),display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1},children:[(0,I.jsxs)(l.A,{children:[(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,I.jsx)(k.A,{sx:{fontSize:12}}),"Properties"]}),(0,I.jsx)(o.A,{variant:"h6",sx:{fontWeight:600},children:t.activeProperties||0})]}),(0,I.jsxs)(l.A,{children:[(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,I.jsx)(W.A,{sx:{fontSize:12}}),"Deals"]}),(0,I.jsx)(o.A,{variant:"h6",sx:{fontWeight:600},children:t.activeDeals||0})]}),(0,I.jsxs)(l.A,{children:[(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,I.jsx)(P,{sx:{fontSize:12}}),"Contacts"]}),(0,I.jsx)(o.A,{variant:"h6",sx:{fontWeight:600},children:t.totalContacts||0})]}),(0,I.jsxs)(l.A,{children:[(0,I.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,I.jsx)(N.A,{sx:{fontSize:12}}),"Win Rate"]}),(0,I.jsx)(w.A,{label:"".concat(t.winRate,"%"),size:"small",color:(i=parseFloat(t.winRate),i>=70?"success":i>=50?"warning":"default"),sx:{mt:.5,height:24,fontSize:"0.75rem"}})]})]})]})})},t.id)})}),ne>1&&(0,I.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,I.jsx)(b.A,{count:ne,page:$,onChange:oe,color:"primary",size:"large",showFirstButton:!0,showLastButton:!0})})]}),(0,I.jsx)(C.A,{open:te.open,autoHideDuration:6e3,onClose:()=>se((0,a.A)((0,a.A)({},te),{},{open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,I.jsx)(S.A,{onClose:()=>se((0,a.A)((0,a.A)({},te),{},{open:!1})),severity:te.severity,sx:{width:"100%"},children:te.message})})]})}}}]);
//# sourceMappingURL=9936.2bf41042.chunk.js.map